<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="John Fox and Georges Monette" />

<meta name="date" content="2024-08-04" />

<title>Extending the cv package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Extending the cv package</h1>
<h4 class="author">John Fox and Georges Monette</h4>
<h4 class="date">2024-08-04</h4>



<p>The <strong>cv</strong> package is designed to be extensible in
several directions. In this vignette, we discuss three kinds of
extensions, ordered by increasing general complexity: (1) adding a
cross-validation cost criterion; (2) adding a model class that’s not
directly accommodated by the <code>cv()</code> default method or by
another directly inherited method, with separate consideration of
mixed-effects models; and (3) adding a new model-selection procedure
suitable for use with <code>selectModel()</code>.</p>
<div id="adding-a-cost-criterion" class="section level2">
<h2>Adding a cost criterion</h2>
<p>A cost criterion suitable for use with <code>cv()</code> or
<code>cvSelect()</code> should take two arguments, <code>y</code> (the
observed response vector) and <code>yhat</code> (a vector of fitted or
predicted response values), and return a numeric index of lack of fit.
The <strong>cv</strong> package supplies several such criteria:
<code>mse(y, yhat)</code>, which returns the mean-squared prediction
error for a numeric response; <code>rmse(y, yhat)</code>, which returns
the (square-)root mean-squared error; <code>medAbsErr(y, yhat)</code>,
which returns the median absolute error; and
<code>BayesRule(y, yhat)</code> (and its non-error-checking version,
<code>BayesRule2(y, yhat))</code>, suitable for use with a binary
regression model, where <code>y</code> is the binary response coded
<code>0</code> for a “failure” or <code>1</code> for a “success”; where
<code>yhat</code> is the predicted probability of success; and where the
proportion of <em>incorrectly</em> classified cases is returned.</p>
<p>To illustrate using a different prediction cost criterion, we’ll base
a cost criterion on the area under the receiver operating characteristic
(“ROC”) curve for a logistic regression. The ROC curve is a graphical
representation of the classification power of a binary regression model,
and the area under the ROC curve (“AUC”), which varies from 0 to 1, is a
common summary measure based on the ROC <span class="citation">(see
&quot;Receiver operating characteristic&quot;, 2023)</span>. The
<strong>Metrics</strong> package <span class="citation">(Hamner &amp;
Frasco, 2018)</span> includes a variety of measures useful for model
selection, including an <code>auc()</code> function. We convert the AUC
into a cost measure by taking its complement:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>AUCcomp <span class="ot">&lt;-</span> <span class="cf">function</span>(y, yhat) <span class="dv">1</span> <span class="sc">-</span> Metrics<span class="sc">::</span><span class="fu">auc</span>(y, yhat)</span></code></pre></div>
<p>We then apply <code>AUCcomp()</code> to the the Mroz logistic
regression, discussed in the introductory vignette on cross-validating
regression models, which we reproduce here. Using the <code>Mroz</code>
data frame from the <strong>carData</strong> package <span class="citation">(Fox &amp; Weisberg, 2019)</span>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Mroz&quot;</span>, <span class="at">package=</span><span class="st">&quot;carData&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>m.mroz <span class="ot">&lt;-</span> <span class="fu">glm</span>(lfp <span class="sc">~</span> ., <span class="at">data=</span>Mroz, <span class="at">family=</span>binomial)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">summary</span>(m.mroz)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; glm(formula = lfp ~ ., family = binomial, data = Mroz)</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; (Intercept)  3.18214    0.64438    4.94  7.9e-07 ***</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; k5          -1.46291    0.19700   -7.43  1.1e-13 ***</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; k618        -0.06457    0.06800   -0.95  0.34234    </span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; age         -0.06287    0.01278   -4.92  8.7e-07 ***</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; wcyes        0.80727    0.22998    3.51  0.00045 ***</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; hcyes        0.11173    0.20604    0.54  0.58762    </span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; lwg          0.60469    0.15082    4.01  6.1e-05 ***</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; inc         -0.03445    0.00821   -4.20  2.7e-05 ***</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 1029.75  on 752  degrees of freedom</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt; Residual deviance:  905.27  on 745  degrees of freedom</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; AIC: 921.3</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="fu">AUCcomp</span>(<span class="fu">with</span>(Mroz, <span class="fu">as.numeric</span>(lfp <span class="sc">==</span> <span class="st">&quot;yes&quot;</span>)), <span class="fu">fitted</span>(m.mroz))</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt; [1] 0.26362</span></span></code></pre></div>
<p>Cross-validating this cost measure is straightforward:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;cv&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: doParallel</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; Loading required package: foreach</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Loading required package: iterators</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; Loading required package: parallel</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">cv</span>(m.mroz, <span class="at">criterion=</span>AUCcomp, <span class="at">seed=</span><span class="dv">3639</span>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; R RNG seed set to 3639</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 10-Fold Cross Validation</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; method: exact</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; criterion: AUCcomp</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; cross-validation criterion = 0.27471</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; full-sample criterion = 0.26362</span></span></code></pre></div>
<p>As expected, the cross-validated complement to the AUC is somewhat
less optimistic than the criterion computed from the model fit to the
whole data set.</p>
<p>As we explain in the vignette “Cross-validating regression models,”
the <code>cv()</code> function differentiates between CV criteria that
are averages of casewise components and criteria that are not.
Computation of bias corrections and confidence intervals is limited to
the former. We show in the technical and computational vignette that the
AUC, and hence its complement, cannot be expressed as averages of
casewise components.</p>
<p><code>cv()</code> looks for a <code>&quot;casewise loss&quot;</code> attribute
of the value returned by a CV criterion function. If this attribute
exists, then the criterion is treated as the mean of casewise
components, and <code>cv()</code> uses the unexported function
<code>getLossFn()</code> to construct a function that returns the
casewise components of the criterion.</p>
<p>We illustrate with the <code>mse()</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>mse</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; function (y, yhat) </span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt;     result &lt;- mean((y - yhat)^2)</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt;     attr(result, &quot;casewise loss&quot;) &lt;- &quot;(y - yhat)^2&quot;</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt;     result</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; &lt;bytecode: 0x63a6f97e4de0&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; &lt;environment: namespace:cv&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>cv<span class="sc">:::</span><span class="fu">getLossFn</span>(<span class="fu">mse</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="fu">rnorm</span>(<span class="dv">100</span>)))</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; function (y, yhat) </span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt;     (y - yhat)^2</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x63a6f9892330&gt;</span></span></code></pre></div>
<p>For this scheme to work, the “casewise loss” attribute must be a
character string (or vector of character strings), here
<code>&quot;(y - yhat)^2&quot;</code>, that evaluates to an expression that is a
function of <code>y</code> and <code>yhat</code>, and that computes the
vector of casewise components of the CV criterion.</p>
</div>
<div id="adding-a-model-class-not-covered-by-the-default-cv-method" class="section level2">
<h2>Adding a model class not covered by the default <code>cv()</code>
method</h2>
<div id="independently-sampled-cases" class="section level3">
<h3>Independently sampled cases</h3>
<p>Suppose that we want to cross-validate a multinomial logistic
regression model fit by the <code>multinom()</code> function in the
<strong>nnet</strong> package <span class="citation">(Venables &amp;
Ripley, 2002)</span>. We borrow an example from <span class="citation">Fox (2016, sec. 14.2.1)</span>, with data from the
British Election Panel Study on vote choice in the 2001 British
election. Data for the example are in the <code>BEPS</code> data frame
in the <strong>carData</strong> package:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BEPS&quot;</span>, <span class="at">package=</span><span class="st">&quot;carData&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">head</span>(BEPS)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;               vote age economic.cond.national economic.cond.household Blair</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 1 Liberal Democrat  43                      3                       3     4</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; 2           Labour  36                      4                       4     4</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; 3           Labour  35                      4                       4     5</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 4           Labour  24                      4                       2     2</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; 5           Labour  41                      2                       2     1</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; 6           Labour  47                      3                       4     4</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt;   Hague Kennedy Europe political.knowledge gender</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; 1     1       4      2                   2 female</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; 2     4       4      5                   2   male</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; 3     2       3      3                   2   male</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; 4     1       3      4                   0 female</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; 5     1       4      6                   2   male</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; 6     4       2      4                   2   male</span></span></code></pre></div>
<p>The polytomous (multi-category) response variable is
<code>vote</code>, a factor with levels <code>&quot;Conservative&quot;</code>,
<code>&quot;Labour&quot;</code>, and <code>&quot;Liberal Democrat&quot;</code>. The
predictors of <code>vote</code> are:</p>
<ul>
<li><code>age</code>, in years;</li>
<li><code>econ.cond.national</code> and
<code>econ.cond.household</code>, the respondent’s ratings of the state
of the economy, on 1 to 5 scales.</li>
<li><code>Blair</code>, <code>Hague</code>, and <code>Kennedy</code>,
ratings of the leaders of the Labour, Conservative, and Liberal
Democratic parties, on 1 to 5 scales.</li>
<li><code>Europe</code>, an 11-point scale on attitude towards European
integration, with high scores representing “Euro-skepticism.”</li>
<li><code>political.knowledge</code>, knowledge of the parties’
positions on European integration, with scores from 0 to 3.</li>
<li><code>gender</code>, <code>&quot;female&quot;</code> or
<code>&quot;male&quot;</code>.</li>
</ul>
<p>The model fit to the data includes an interaction between
<code>Europe</code> and <code>political.knowledge</code>; the other
predictors enter the model additively:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;nnet&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>m.beps <span class="ot">&lt;-</span> <span class="fu">multinom</span>(</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  vote <span class="sc">~</span> age <span class="sc">+</span> gender <span class="sc">+</span> economic.cond.national <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    economic.cond.household <span class="sc">+</span> Blair <span class="sc">+</span> Hague <span class="sc">+</span> Kennedy <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    Europe <span class="sc">*</span> political.knowledge,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="at">data =</span> BEPS</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; # weights:  36 (22 variable)</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; initial  value 1675.383740 </span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; iter  10 value 1240.047788</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; iter  20 value 1163.199642</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; iter  30 value 1116.519687</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; final  value 1116.519666 </span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; converged</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m.beps)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table (Type II tests)</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; Response: vote</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt;                            LR Chisq Df Pr(&gt;Chisq)    </span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; age                            13.9  2    0.00097 ***</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt; gender                          0.5  2    0.79726    </span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; economic.cond.national         30.6  2    2.3e-07 ***</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; economic.cond.household         5.7  2    0.05926 .  </span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; Blair                         135.4  2    &lt; 2e-16 ***</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt; Hague                         166.8  2    &lt; 2e-16 ***</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; Kennedy                        68.9  2    1.1e-15 ***</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt; Europe                         78.0  2    &lt; 2e-16 ***</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt; political.knowledge            55.6  2    8.6e-13 ***</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt; Europe:political.knowledge     50.8  2    9.3e-12 ***</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Most of the predictors, including the <code>Europe</code> <span class="math inline">\(\times\)</span> <code>political.knowledge</code>
interaction, are associated with very small <span class="math inline">\(p\)</span>-values; the <code>Anova()</code>
function is from the <strong>car</strong> package <span class="citation">(Fox &amp; Weisberg, 2019)</span>.</p>
<p>Here’s an “effect plot”, using the the <strong>effects</strong>
package <span class="citation">(Fox &amp; Weisberg, 2019)</span> to
visualize the <code>Europe</code> <span class="math inline">\(\times\)</span> <code>political.knowledge</code>
interaction in a “stacked-area” graph:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  effects<span class="sc">::</span><span class="fu">Effect</span>(</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Europe&quot;</span>, <span class="st">&quot;political.knowledge&quot;</span>),</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    m.beps,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    <span class="at">xlevels =</span> <span class="fu">list</span>(<span class="at">Europe =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">political.knowledge =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    <span class="at">fixed.predictors =</span> <span class="fu">list</span>(<span class="at">given.values =</span> <span class="fu">c</span>(<span class="at">gendermale =</span> <span class="fl">0.5</span>))</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  ),</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="at">lines =</span> <span class="fu">list</span>(<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>)),</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="at">axes =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">list</span>(<span class="at">rug =</span> <span class="cn">FALSE</span>), <span class="at">y =</span> <span class="fu">list</span>(<span class="at">style =</span> <span class="st">&quot;stacked&quot;</span>))</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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qyQMVWzYsMHV1VUd8VRs3759HTp0cHR07Nmzp8ZuYFgpjpaKaWu0CMLDw8PCwrTVe1kcLRXT1mhZt25dx44dxWKxj4/PihUrNHMz6EpxtFRMK6MlJydn+vTpXl5ednZ27du337t3r4YDeFFMENWoW7duivkNK1euXLx4cdly0oBDhw4NGTKkefPmq1atMjAw+N///qf1u+6WxdFSrchksrlz5546dUrbgZSPo6WaWLRo0dSpU1u1avXbb7998MEH33333Y8//qjtoErjaKkmJk2atGnTpoCAgM2bNzdt2nTIkCHh4eHaDqoir90klRf1KvOPNmzY8ELlaqWx+W7V0MqVKzt16rRs2TIAXbp08fHx2bBhw+zZs6u8I46WWiAhISEsLGz37t0XLlxo27at+jriaKnpCgsLf/755zFjxixYsABAly5dioqKVqxYMX369Cqftc3RUtNlZ2fv2LFj7dq1n3zyCYDOnTtHRUXt2LHDz89P26E9F48gli8uLs7MzOzo0aNNmjSxtLRs0aLFTz/9pHhVJpMtXrzY19fX3t6+Y8eOf/31V7mNODk5CQfwO3XqtH379pCQEDMzs+zsbEU5gOLi4gULFvj4+Dg7O/v7+9+4cUMof/r06bRp07y9vW1sbN56661FixapuCCRTCYbPny4m5ubsNyjp6dnYGBg7969LS0tHR0dhw4dmpGRUfG76Ny586effio8PnXqlJmZ2dixY4WnYWFhZmZmV65cKdvvn3/+2b59e1tb23feeWfLli2K8tzc3EmTJnl6enp6ek6ePLmgoEA51Llz5zZp0qRx48Zz5syZPn36wIEDK23wRWVmZp44ceLDDz8UnhobG3fp0qVq19niaBEe14LRAuD69es7d+6UyWSvsv5lBThahMe1YLQkJiY+efKkW7duihJfX9+8vLwqPEHB0SI8rgWjJSUlpV27du+8847wVCQS2djY5OXlvXSDGsAEsSKffvpp586d//zzz65du3777bc//PCDUP7VV18tXrz4k08+2bhxo4eHx8cff1zxtUo7d+7s3bt3586d79y5U7duXeWXJk6c+Msvv4wZM2bp0qV5eXkdO3YUdi5jxozZunXryJEjf//9927dun3//fe7du1SJebJkyf//fffe/bsefPNN4WSefPmWVtbh4WF/d///d+BAwfmz59f8bvo2LFjZGSk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oGXLlhXYLCMjY/ny5X369ClbNufR5CtWrJg7d67V4UVERMR+/khk0AIahPDnj5yDxSWxHQIjAToU/5uw87G+IGZnZ4eEhFSrVq1ly5aPP/5406ZNAwICpkyZYsVbxcTEAIGBgXkjgYGBUVFR6enpV2925syZCxcuNG3aNDMz8/Dhw+fOnfPz82vUqJHVX4KIiIjYQ+JFRoVT/UV+2cpJ2AS+Rkeyk29gPWWg4FGt4s76u5jfeeed6dOnv/rqq7179w4ICIiJiVmyZMkbb7zh6elZ2BtHYmNjgYoVK+aN+Pr6ms3mlJSUSpUq5Q3GxcUBP/zwQ5cuXSxnutu3b79o0SI/P79r3/Onn3568803rx2PiopKSkoqVDwRERG5RfuiWPAty3fh9yd74V6j89hVJrwE8Cp422mKpKSkU6dOtWvX7tpPTZo0qVmzZnaa1/qCuHTp0pCQkLxDhj4+PpMnT87KygoNDS1sQTSbzYDJZCow4urqevVmFy5cAGbNmrVq1aoHH3xw3759PXv2fP755z///PNr37NBgwavv/76teODBg3y9rbXf0UREZHSKfkSy3cz7xt+jqIprIWWRkdygI/gMBWh4C0TNuTt7V25cuXrVpoGDRrYb17rC2JCQkLLlgX/67dq1WrevHmFfSvLIcCrD+wlJSW5u7tffUyR3EOMkyZNsvToVq1avfXWW0OGDElKSvLx8SnwnuXLl2/btu21c3l5ebm4lLB7p0RERAyz9xShW1nxI14XGVYS71C+kcScYjjfrrO4uLjcqNLYd16r/2arVq02b95cYHDz5s333XdfYd+qWrVqJpPp+PHjeSORkZEBAQEFNqtatSpQq1atvJGaNWuixV1EREQcLiaRKZ9TZyT/fIvorey+SDS8VmraITAG4rgHuhsdxC4KfQTx559/tnzwwgsvPP3000lJSU899VTVqlVjY2OXL18eHh6+cePGwr6nr69v69at165d27t3byAzM9PyWMQCm9WqVatBgwZfffXVI488YhnZtm1bhQoVateuXdgZRURExApZ2Ww7QuhWVv5IfRgJLxgdyRBHYDYuJWPZ5esqdEEssMBJeHh4eHj41SOPPfaY5QrCQgkJCencufOECRPatGkzZ86cxMTEQYMGWT4VGhq6bdu2hQsXuru7v/3227179zaZTA899NCOHTumT58+depUnTIWERGxt2Nn+Xg7C78jNZnuEFsylhy21ssAwfAPo4PYS6EL4okTJ+yRo2PHjuHh4VOnTp0+fXqTJk22bt2adyp5z5494eHh8+fPd3d3f/LJJ81m84cffjhjxow6derMnz+/b9++9sgjIiIiQGoan+3mf9v58TjNYRm0NjqS4dbCV7jDIqOD2FGhC+LNz+cmJCTMmDFj/PjxVkQJDg4ODg6+djwsLCwsLCzv5VNPPfXUU09Z8f4iIiJyK7KyiTjJlkNsOUTEKbzTGADboKzRwZzBFQgBGF9CH/udw/q7mM1m87Jly37++efs7Oy8wSNHjuzevdu6gigiIiIGOnkupxR+c5jUP6kDHeATqG50MKcyHX7jDrjOc2dKkiI9KHvs2LH16tU7efJk5cqV77zzzt9//z0lJeWjjz6yYT4RERGxn/OpbDvClkN8dZDT8dwBj8AX0NToYM4pDqYDLDQ4h/1ZXxAXLlw4YsSIDz/8cP78+WvWrNm4cePly5cfeeQRX9+SupqOiIhISXA5nZ3Hcw4W7jtFRXgA3oGepekhNdZ5Hc7THK6zrkkJY31BjImJadOmDXD//fePGzcO8PDweOONN955552goCBb5RMREZGiS7zIL6f5IZIth/jpN1zTuA8GQN+SfSWdTe2BRbjCKqODOIL1BTEgIMDyaOs6derExMTEx8dXrlzZ19f38OHDtosnIiIihZaRxbGzHDzNL9H8cpqD0ZxJoDzUhi7wKfgZnbDYMecsu9wP7jA4ikNYXxCDgoImTpzo5eU1aNCgRo0ajRs3buTIkTNnzrx2BRQRERGxq8SLHD7D3lMc+YPDZ/j5NFfSqAT1oQm8BG3A1eiQxdoK2IUnzDU6iIMU6SaVM2fOfP3114MGDZo9e/ajjz46Z86cMmXKLF261Ib5RERESoDLkJycbKt3S/iTU+f4+TQHozkYzc+/k/gnPlATGsNgeAx0Q4ANpcMbABOKUpyKF+u/Tm9v71Wrck7Dt2zZMi4uLiIiom7dujVq1LBRNhERkZJgBuwDd3f3Qv2t9Ez+SOT0eX4/z+kETp8n+gKnzxMVz+V0PMAfAuFf8CHcbafoAsBH8BtV4BWjgzhOUYvwhQsXjh49GhcXd+edd7Zo0cLLy8smsUREREqGL+ElXCCgXLnr3w1iNpsPnWHPSaLicypg9AWi4olJxA284HaoCrWgOQyG5rqC0LGS4V2AUKODOJT1BTE7O/u1116bPXt2WlqaZcTHx2fUqFGvv17CHx0pIiJyi45AX4C5N1mWLTk5ufO73AZVoDr8HzwC98M9WrnEObwLcdSHrkYHcagiXYM4ffr0V199tXfv3gEBATExMUuWLHnjjTc8PT2HDRtmw4giIiLF0XnoAnEMgQE3KYg+Pj77Y2OrOjKZ3LI/YAom+MToII5mfUFcunRpSEjIlClTLC99fHwmT56clZUVGhqqgigiIqVcGnSB33gY5hidRaw3GuChUriyjPWPTE9ISGjZsmWBwVatWkVHRxctkoiISPFmhudhFwGw1egsYr2fYTEu8KnRQQxgfUFs1arV5s2bCwxu3rz5vvvuK1okERGR4m08LMUL9mvtumLtVYAnoJrRQQxQ6FPMP//8s+WDF1544emnn05KSnrqqaeqVq0aGxu7fPny8PDwjRs32jqkiIhIsbECxuMGu6GS0VnEel/A15SFBUYHMUahC2Ljxo2vfhkeHh4eHn71yGOPPWY2m4uaS0REpBiKgCdwgWXQ0OgsYr3snCdjjwRPo7MYo9AF8cSJE/bIISIiUtz9Dl0A3oBgo7NIkXwC+6kAk4wOYphCF8TatWsXGElPT4+Nja1SpcqNHgEqIiJS4qVCFzhLd3jH6CxSJGkwFmBqab6EtEhf+bp16+69914PD48aNWp4enrec88969ats1UyERGR4iILesIv1INVRmeRovoQThMAg4wOYiTrC+L69eu7detWrVq1hQsXfv3114sXL65Zs2a3bt02bNhgw3wiIiLO72XYwO1wwOggUlTnYTrA/4wOYjDrH5Q9adKk/v37L1jw1909vXr1GjBgwKRJkzp16mSLbCIiIsXAfJhJWdgLutSq2JsA57kH2hkdxGDWH0E8cuRI9+7dCwwGBwcfPny4aJFERESKja9gAC6wCWoYnUWK6iTMxFQ6n4xdgPUFMSAg4NChQwUGDx48WL169aJFEhERKR6OQm+AD6CN0VnEBl4H+Bc0MDqI8aw/xdyzZ89x48Z5eno+8cQTVapUOXfu3MqVK8eMGfPmm2/aMJ+IiIhzSoAucI5BMMLoLGIDP8FKXGGJ0UGcgvUF8c0334yLixs5cuTw4cNdXFyys7Pd3NwGDhw4evRoG+YTERFxQunwOJygJcw1OovYxisAz2r9GwsrC2JGRkZMTMy0adNGjRq1f//+mJiYO+64o3Hjxjq/LCIiJZ4ZnoftVINtRmcR21gD31MOPjI6iLOwsiBmZ2ffe++98+fP7969e0BAgG0ziYiIOLOJsBhPOFCUE3HiPDLhLYC39R80j5U3qbi7u/fv3/+TTz7RsssiIlKqfAZv4wa7dC6yxAiFI1QEXSP3F+ubcrNmzbZv337vvfd26NDBz8/PxeWvrvnSSy/ZIpuIiIhz2QVP4gLL4G6js4ht/Jmz4vIso4M4F+sLYl4LXLRo0Y0+JSIiUmKcgscB3oBgo7OIzbwPMdSGnkYHcS7WF8SzZ8/aMIeIiIgzS4EucJYn4B2js4jNxMAc0KNtrlXUizFTU1OPHj0aHR3t7+/foEEDHx8fm8QSERFxHhnQHQ7RDJYbnUVsaSwk0ByaGx3E6VhfEM1m8/jx46dPn56ammoZ8fT0HDFixMSJE00mk43iiYiIGMwMA+Ab/GCH0VnElo7CfFx0+PC6rF9qb8qUKRMmTBgyZMjBgwcTExOPHDkyYsSI9957b8qUKTbMJyIiYqx3YBGe8AuUNTqL2NKrAF2httFBnJH1RxAXLlwYEhKSVwd9fHwmTZqUnZ29aNGiUaNG2SieiIiIkT6DsbjBj1DF6CxiS9thI26w0OggTsrKI4iZmZnHjx9v2bJlgfGWLVvGxcUVOZWIiIjxvs95qM1yaGh0FrElM4QAvAjeRmdxUlYWRFdX1+rVq2/cuLHA+IYNG65tjSIiIsXOSXgSYDJ0NzqL2NgyiMALPjA6iPOy8hSzyWSaN29e9+7dL1y48NRTT1WtWjU2Nnb58uWff/55eHj43r17LZs1atSobFldsSEiIsVMAnSEGJ6G143OIjZ2Gd4EeLcod2KUeNZfg9ixY0dg5cqVK1euvHq8W7dueR9HRUXVqFHD6ilEREQcLx16wHFawKdGZxHbex+iCIBhRgdxatYXxBMnTvztNtWqVbP6/UVERBzPDM/DNgJgu9FZxPbO5Kypt8zoIM7O+oJYu7ZuCxcRkZLmbViMF+wv+loS4oRegfM8Arpf4m8U+uz7ggULsrKy/naz7OzsTz/99NKlS7f+zqtWrWrWrJmPj8+jjz564MCBv91+06ZNa9asufX3FxERubmFMJEy8BNUMjqL2N738BmuWg7nVhS6IB49evTuu+/+8MMPY2Njr7tBQkLC7Nmz77333h07dtz6HSobN27s0aNHkyZN5s+f7+7u3rJly+jo6Jtsf+zYsR49eqxevbqw+UVERK7rO3gWF1gPDYzOIraXBS8CDNcjLW9FoY+fT5s27ZlnnnnvvfdGjRpVp06dpk2b3nHHHd7e3qmpqbGxsREREUePHn3sscdCQ0MfeOCBW3/bDz74oH379nPmzAGCgoLq1as3d+7cSZMmXXfjjIyMXr16FerwpIiIyE38Ck8ATIEORmcRu5gHP+MN04wOUjxYc4FF48aNw8PDY2Njv/zyy2+//XbXrl0JCQm+vr533nnnsGHDOnToEBAQUKg3TExM3LZt24IFCywvPTw8goKCli1bdqOCOGbMGFdX1/vvv9+K8CIiIgWchy4Qx8CcxydLiZMIEwDm69E2t8j6K3CrVq3at2/fvn37Fj1ETEwMEBgYmDcSGBg4b9689PT0a09Sb9++ffbs2Xv37rXJ1CIiUsqlQReI5GGYZ3TSXarCAAAgAElEQVQWsZcxEEcj6GF0kGLDKW7RslzOWLFixbwRX19fs9mckpJSqVK+y4STkpL69OkzderUunXr3vw9IyMj8w5JXi0uLk7npkVExMIMz8Eu7oStRmcRezkMs3GBlX+/qfO5dOlSbGzsqFGjrv3Uc889949//MNO8zpFQTSbzYDJZCow4urqWmDLwYMH33XXXYMHD/7b9/Tw8Li6ceZxc3O79m1FRKR0GgWfchsc1JnHEuxlgB7wN4eWnJOrq6urq+u1lcbNzc3Dw8N+8zpFQfTz8wOSkpLyRpKSktzd3Qv86wgPD9+yZcuhQ4du5T0DAgJef/066yMtXbrU3d29aHlFRKQkmAPvUxb2grfRWcReVsDXuMNCo4NYyd3dvXLlytetNHblFL8wVatWzWQyHT9+PG8kMjLy2jtdfvzxx4SEBH9/f5PJZDKZdu/evWTJEpPJtG7dOsfmFRGRYi8chuIKX4PWfSixLsNrAO9BOaOzFDM2OIIYHR2dnJzcsGFDq9/B19e3devWa9eu7d27N5CZmWl5LGKBzYYMGdKpU6e8l8OGDbvjjjtGjx599913Wz21iIiUQt/A07jAUmhldBaxo/chiuowwuggxU+RCuKXX37Zr18/yy0mZrO5bdu2Xbt2HTbMmtWvQ0JCOnfuPGHChDZt2syZMycxMXHQoEGWT4WGhm7btm3hwoV169a9+t6U2267zd/fv02bNkX5EkREpLT5CZ4GmAlPGp1F7Cg6Z9nlT40OUixZf4p5yZIlnTp16tKly+LFiy0jLVq0eOmll0JDQ614t44dO4aHh2/cuDEoKCguLm7r1q21atWyfGrPnj3h4eGZmZlWRxUREbGIhO4Qzzh4wegsYl9adrkorD+C+O677w4bNmz69OkJCQmWkQkTJqSlpc2cOXPgwIFWvGFwcHBwcPC142FhYWFhYdeO79q1y4pZRESk1DoD7eAPnoOxRmcR+/oeVuCmZZetZv0RxKioqHbt2hUYbN269alTp4oWSURExPbOw7/gd7rAfKOziH3lLrv8kpZdtpr1BbF+/fo//vhjgcGIiIjatXU7mIiIOJdL0AWO0hL04IuSL3fZ5feNDlKMWX+KediwYQMHDnRzc7PcJhIfH//5559PnDjxvffes108ERGRokqH7rCLBrDD6Cxid1p22SasL4j9+vVLTU0dP378mDFjgCpVqri7u48cOXLECN1MLiIiziIbesOX+MN+o7OII7ylZZdtwfqCmJyc/OKLL/bv3//w4cNRUVGVK1du1KhRxYoVU1NTvb31SHoREXEKL8NnVIRfoazRWcTuDsOcYrvsslOxviD6+PjExsb6+fk1a9asWbNmlsGIiIg2bdokJyfbKJ6IiIj13oIZeMFhLaZXSgyD4rvsslMpdEGMiIiYNGmS5eN+/fqVK5dv7ZrIyMjbb7/dNtFERESKYA5MogzsBn+js4gjrIBtxXnZZadS6ILo5uZWvnx5y8deXl4eHh5Xf7ZZs2Z9+vSxTTQRERFrfZqz1PJWsH4lWClGtOyybRW6IDZu3NiydMqJEydCQ0N9fX3tkEpERMR6W6AXLrBGq2iUHlO07LJNWX8NYt5CJunp6bGxsVWqVClwullERMTxfoR2uMBs6Gx0FnGQaJgNWnbZhor0iKB169bde++9Hh4eNWrU8PT0vOeee9at0wNIRUTEMIehK8A4GGxwFHEgLbtsc9YXxPXr13fr1q1atWoLFy78+uuvFy9eXLNmzW7dum3YsMGG+URERG5RNHSCOIbBGKOziOPkLru8wuggJYr1p5gnTZrUv3//BQsW5I306tVrwIABkyZN6tSpky2yiYiI3Kp4aAdRdIMZRmcRx7lq2eVKRmcpUaw/gnjkyJHu3bsXGAwODj58+HDRIomIiBROInSAYzwMa4zOIg71EfyMD0wzOkhJY31BDAgIOHToUIHBgwcPVq9evWiRRERECuE8tIF9NIVvjc4iDvVbzrLLS40OUgJZf4q5Z8+e48aN8/T0fOKJJ6pUqXLu3LmVK1eOGTPmzTfftGE+ERGRmzgH7eAXHoDdRmcRh8qG/hBPMDxmdJYSyPqC+Oabb8bFxY0cOXL48OEuLi7Z2dlubm4DBw4cPXq0DfOJiIjcSBy0hUM0h11GZxFHmwLf4QvLjQ5SMllfEF1cXGbNmjVq1Kj9+/fHxMTccccdjRs31vllESkNsmAlXILMzEyjs5ResdAGjtAathqdRRztZ3gDF9hYxAf2yY1YXxCHDh36zDPPPPjggwEBATYMJCLizC7C/+BDOIUPXHJzs34vKkURDY/CCdrC10ZnEUe7An0ABkJzo7OUWNb37nXr1rVo0eL//u//3n777WPHjtkwk4iIE4qHcVALhuN3ilBIBC+jQ5VSv0NrOEE3tcPSaQz8gj98ZHSQksz6ghgdHb1r167HH398yZIl9evXb9q06X/+85/Y2FgbhhMRcQYn4SWogmk8/xfPZoiFAUaHKr2i4FH4jWA90aZ02glTcYEtRgcp4awviCaTqXnz5lOnTj158uS+ffvat28/b968gICADh062DCfiIiB9kEfqI3LDJrDPvgNtIsz0nFoBSd5UstmlE4XoR/AW9DA4CglnW2unqlTp07jxo1///33qKioLVtU6kWkeDPDBpgBW3CDzhCqRRqcwa/wL4jmOZhvdBYxxktwgkAYb3SQkq9I9/5ER0fPmTOnQ4cOlSpV6tmz57lz52bMmHH27FlbhRMRcbB0+AQaQhc8tjAQUmG12qEzOArtIJpBaoel1pewgDLwjdFBSgXrjyDed999+/fvd3d3b9eu3bx587p27VqxYkUbJhMRcaQU+BimwRl84QV4x+hE8pcD0AHiGAJzjM4ixjgP/QGmgb/RWUoF6wtizZo1Q0JCOnXq5O3tbcNAIiIOFgmzYCkk8A+YCl2NTiT57INOEMfr8J7RWcQwL0AMzWG40UFKC+sL4urVq22YQ0TEwczwNcyAjbjAAzAb7jU6lBQUAZ0hltEw2egsYphPYAXusNnoIKWIHvEqIqXOn/ApzIRDlIUg3YPitL6H7hDPWzrjX5r9Aa8BLAYfo7OUIiqIIlKKnIRQWADn8YOREKJ1upzWd/AExDMlpx5IqWSG5yCOjtDD6CyliwqiiJQK38MMWIEJ7oZZ0NLoRHIz30JrXOB9eMXoLGKk/8KXVIC1RgcpdVQQRaQkuwLLYRoczDmbPBeqGB1K/sZG6IQLzIFBRmcRI/0KL+MCq6Cs0VlKHRVEESmZYiAU5kB8zmNrxutscrEwB4biAvPhWaOziJEyoS9AT2hndJbSSAVRREqavfBfWIwJ6sM0eMzoRHJLsuBNmII7fAWtjI4jBnsHfuJ2WGR0kFJKBVFESogkWALzcu5N/jf8F/yMDiW3KhV6wgZuh/1Q3eg4YrB9MAEX2KID/0ZRQRSRYm8vhMIKSCQAhune5GLnFHSGwwTCPihndBwxWBr0ARgOjY3OUnqpIIpIcZUC4TAX9lMG2sI0aGB0KCm0XRAMMQTDCqOziFN4DQ5TCz40OkippoIoIsWP5ZDhckjW4wyLueXwFC4wBsYZnUWcwjcwE1f42uggpZ0KoogUG6mwDObBPlyhKcyApkaHEiuZYTyMpwysgs5GxxGnkAzPAYyD2gZHKfVUEEWkGDgC82ARJOMLfeE9PRetWEuD5+BTKsBuXRggeV6E37kH3jI6iKggiogTS4PPIRS25Bwy/BCaGx1KiuosdIU93Ak/a3VdyfM/WEJZ2GJ0EAEVRBFxQmbYCQthDVzAH4bAaO2vSoZfoAv8zsPwrdFZxIlsgudwgXVQyegsAk51WfeqVauaNWvm4+Pz6KOPHjhw4EabzZo1q3nz5hUqVKhfv/60adMyMzMdGVJE7CoKJsA/4CHcFxB0gf0QA2PUDkuGTXAPLr/zutqhXC0C+gHMgQ4GR5FczlIQN27c2KNHjyZNmsyfP9/d3b1ly5bR0dHXbjZx4sRhw4b985//DA8P//e//z169OgJEyY4Pq2I2NZlWAHtoBamsQT+xmxIgw16ClpJ8l8IwhUWwntGZxEnchK6Qjyva+ltp+Isv5R/8MEH7du3nzNnDhAUFFSvXr25c+dOmjTp6m3S09OnTp06fPjwDz74wLJZRkbGtGnTxo4d6+rqakxuESmCbPgBFuc8sMZy98kEKG90LrGxdBgEC/GAbfCA0XHEiZyHjhDDE/q1wdk4xRHExMTEbdu29ejRw/LSw8MjKCho2bJlBTY7c+ZMSkpKp06d8kYefPDBy5cvnz592nFZRcQWTsOU3FPJoXRM5iAkwHS1w5LnArSHhVSD02qHcrVL0BmO8zAsNzqLFOQUBTEmJgYIDAzMGwkMDIyKikpPT796s2rVqp04caJVq79WcN+5c6eHh4e/v7/DoopIUSTDJ9AOamAaReBJlkIabIKGRkcTuzgIzeBbWsBp3XwgV8uAYNhNPV2Q6pyc4hRzbGwsULFixbwRX19fs9mckpJSqdJfOxR3d/fatf96cubSpUtnzpz58ssvlyt3nYU7z58/v23btmvHk5OTdV+LiINlwtfwCXwBSQRAfxitJXdLNjP8F17GBQbDbKPjiHMxw2DYTBW44T2pYpGZmZmcnLxixXUWomzduvXVNcm2nKIgms1mwGQyFRi50ZWF8fHxr7zyyuLFi/v16zd58uTrbnP27NlVq1ZlZ2cXGE9JSbl8+bJtcovITWXBd7AcVkM8FSAIJkMto3OJ3cXCc7CJ8rAa2hkdR5zOGPgfXnBQvyj+rcuXL6ekpFxbEF1cXOrXr1/CC6Kfnx+QlJSUN5KUlOTu7n71McU8mzZtevbZZ728vNauXdu1a9cbvWejRo3Cw8OvHb/77rsrVKhgi9QickN74RNYAWdxh+YwFlobHUocZBUMhTiawzfgaXQccTqhMIkysBuqGJ2lGKhQoUL16tU/++wzB8/rFNcgVqtWzWQyHT9+PG8kMjIyICDg2i03bdrUpUuX4ODgI0eO3KQdioghDsM4qANNcJ/Bw2fZDGnwrdphKZECgyCYMnF8BLvUDuVaG2AQLrBRVx47Oac4gujr69u6deu1a9f27t0byMzMtDwWscBmmZmZAwYM6Nmz5+zZupxFxIkchhWwDI7jBnfBa9DT6FDiaLugN/zG/8EP4Gd0HHFGP0FnXGCeLjxwfk5REIGQkJDOnTtPmDChTZs2c+bMSUxMHDQo54GZoaGh27ZtW7hw4c6dO2NiYvz9/RctWnT1333yySeve5+KiNhVFKyDT2AfrtAQBsILRocSA2TCRBiPC4yGiUbHESd1Av4NMB6eNzqL/D1nKYgdO3YMDw+fOnXq9OnTmzRpsnXr1lq1cq5k37NnT3h4+Pz58yMjI4H333+/wN/t0KGDCqKIw5yEz2A5HMAV7oYXoL+TXK8ijncUnoF9VIKvtfKN3MhZ+BfE0B/eMjqL3BJnKYhAcHBwcHDwteNhYWFhYWHAoEGD8g4riogjmWEfrIO1cBAXaAADYYhT7UPEwcwQlnM9WVdYqV8S5EZSIQhO8S9YYHQWuVXauYvIDWXBLtgAqyGSMtAAesJwPZlC4uB52IAXrIZ/GR1HnJflgdj7aQBfGp1FCkEFUUQKugxbYAOshXM5z6l5Hp4xOpc4i9Xwgh5kI7fADM/DV/jBfqOzSOGoIIpIjgTYCBvgK0jGG9rAm3C/0bnEiaRCCITiBv/VPUnyt16HTygPh6Cs0VmkcEp1QTSbzVcgETx0wkxKsVOwHjbAFkxQBbrCW1Dd6FzidH6EZ+CEHmQjt+YjmIo7HNAy3MVRqS6Ix48fXwyLMYHZMpLXFG/lg/JQBoDbwAVc4DYAykB5AMqBR/4tLSvDlAUvALxyf6W6zooxIvaUATvhC9gAh3GFetALhud+84rkEw9j4SNc4HW4/gKnIldbBy/gCluhttFZxBqluiDWq1cPnoewvJHLXLhMMpBIEqQAkASpAKTAnwCkwkUAkiEdgAtghqzcv5IOluWer+RucAWyAEgDIDv3ZVZuNzVzVXG0FEoT+AC5lfTmL8ltmZaXeW3V8lZ5ndXSZfOaq5Q2p+EL+AK2QjJecD/0g766/1RuJAPmwEQ4TyCshbpGJ5JiYAE8jwssgxZGZxErleqCeD2+4GvU3OmkpJMAJHIO0iAb/gByu6kZ4gC4CJfADBcAuARXwJxbTy2t1JxbUtMh+6pKmglY+miBEmmpp3m9swK45dZNN7AsX+0Dptzt3cETXMH7qr9lKaCWDXTi3klkwu6cM8jsxQXugEfgFT2yTv7W5zASTuAL/wOtbip/LxPegimUhdUQZHQcsZ4KolPxBm8AajlgsmwyE4nmrz56ES5AVm4NPQ+ZuWU0PfcwaiIAFyET0uEKZOceFrX8MwPIPTJqJrdHWipmXo+0FE1Lm/QG19xOaTnn7gnuuf3ScrCzbO6nvHLf0F13Tv6dk7Al908innA39IaB+qmXW3EEXoEvcIc3YYzRcaR4OA9PwlYqwx6oYXQcKRL9r6I0c8ttonbso1dIuUICXI4nHjLhLAAxAMRDVm4rTYZMSIVMuJzbPtMhAzIgCzJyj4NaDoiaya2PV//T45pBS7O0HBC1lFEfcMn952255dVyFv6S/f5FOMRl2JlbCnMPFj4GoxzzK4eUDOfhHZiR8/jrcN18KrfoZ/g3nKI57FC7KAH0n1DsLe+wqO2lkZRGIjkXjFquFrWcjk+BS5AKaZAK6ZCSe5GoOfd8veU0veXsfGZe7yx74YKd0tpJFuyDbfAN7IJUfOBBeBYe15WFUijp8FHO5Yb3wOe6k11u3XJ4Chd4GaYZnUVsQwVRijWf3LPWthLr63uvTd/QLrLhIGyDrbADkigH9aAjvAjVjE4nxdLn8BKcwg+Ww8NGx5FiIwvehCmUgXDobnQcsRkVRJFiI++ywm1wnjJQBx6C56Gp0dGkGNsLL8MOPOE9GGZ0HClOUuAZ+Jzb4AdoYHQcsSUVRBGndhK+h52wGaL/ugd5KDQ3OpoUe3/ABAjFFZ6GBbrcUArlOHSFXwmECN03WPKoIIo4nVPwbe4Z5D9whZrwCPTXE8XEVi7BTJgO52gOq8Hf6ERSzGyE5yCO52C+0VnELlQQRYyXAfvgB/gBdsJZXCEAWkFfaGN0OilRLsA8mAUx1IRweMDoRFLMmOF9GIUrhMGzRscRe1FBFDFGCvyUe/p4N/yJO1SDFhCsJxKLPZyE/8JiSOT/YKruJxAr/Al9YTXesAPuNjqO2JEKoojjWC4o3As7YS8mqAANoC3003KlYj97c6qhCe6GMN3VJNY5Af+GQwTCT1q3vcRTQRSxo8sQkXvieBecxw0CoFnuYULdEyB2lA0bYQrspAx0grlQxehQUlx9Cb0hnu6wyugs4ggqiCK2lAG/QETunwMAXlAXHoHeUAwesiglwJ/wKXwAx/GEZ2CmfhuRogiFQbjABzDC6CziICqIIkWSBb/C3tw/P/91NeE90BaeAl+jM0opEgtzYTacxw/GwyCjE0nxFgUjYQ1esE0XJ5QqKogihRaTex3h93AALuY8nrAptIUnoJLRAaU0+hnmQCguUA/+A/8yOpEUb4kwGaZhgtawGm4zOpE4lAqiyC35888/I6E17IMUyoB/7jHCHnqGnBjIDN/Af2EDLvAQfAy1jA4lxVsGfAxjIZb/g1XQ2OhEYgAVRJFbdY7bz/EqPKH/AYszOAzLYBmcxBOehfe1moUU3ecwEk7gC/Mg2Og4YhgVRJFbUr58eagPrxsdREq7aFgNK2AnrtAQBsILRoeSkuAnCIEduMNoGGt0HDGYCqKISDGQAKvgE9iJCWrBIBipfbjYxO8wBhZrVW65inYuIiLOKxnWwQrYgAmqQT8YrVPJYisX4H2YgglawWo9dUHyqCCKiDidNPgaVuQsf1IFusI7esy12FA6fASTIJ5A+AwaGp1InIsKooiIs8iCXbAYPoMkvKENvAd1jc4lJYoZVsIoOIkvLIBuRicSZ6SCKCJisBjYAlvgC4jHG9rDOGhgdC4pgXbDK/ADXjAZhhsdR5yXCqKIiAFS4dvcXngk5/rCh+FFaG50NCmBkmEFfAI7cIOhMB1cjA4lTk0FUUTEQbLgQG4p3ALgCXfDv2E4lDM6nZRAmfAFLIavIIkA6Atv6CYnuRUqiCIi9nUytxF+DUmUgTrQAV7VGjxiP4dhMSyEODyhvS5mlcJSQRQRsb1M+CS3F579qxQOgX8YHU1Ksj9gJSyEA7hBE5gIbYwOJcWSCqKIiI1lZWWlYupLNXgEnoeHjU4kJdxl2ACf5Dwv0/Ic9RBdZShFoYIoImJjrq6u4APRRgeREi4bfoDFsByS8YVgmASVjM4lJYEKooiISHGSCrvgS1gGZykPj8FEXb0gtqWCKCIi4uxi4fvcP3sxgTfcC6PhX0ZHk5JJBVFERMQZnYTvYSd8n/OwzIrQCB6DgeBjdDop4VQQRUREnEIW/JrbCL+FaFzgDmgK3eEp/S9bHEnfbSIiIkbKyMh4Hw7Cj5BKOagDD0NveMDoaFJ6qSCKiIgYKS0t7UOawGPQD2oZHUcEnOohSatWrWrWrJmPj8+jjz564MCBIm4mIiJSLFSoUAE+h/Fqh+I8nKUgbty4sUePHk2aNJk/f767u3vLli2jo6/zCLFb3ExERERErOYsBfGDDz5o3779nDlzgoODV69e7evrO3fuXKs3ExERERGrOUVBTExM3LZtW48ePSwvPTw8goKCli1bZt1mIiIiIlIUTlEQY2JigMDAwLyRwMDAqKio9PR0KzYTERERkaJwiruYY2NjgYoVK+aN+Pr6ms3mlJSUSpUqFXYzi4yMjIMHD5rN5gLjaWlpR44csXTK33//HU7AElt/QVJ8JWdkZOzdu9fyIiMj49y5c5aXx44dg3h9t0h+6QcOHPD29gb+/PNPwPLdkpKSAun6bpH84o8dO1auXDng3Llz6enpV+9qYBXcZmg8cSonfv+9quU7JDIyMi0tLe+7JY+rq+tdd91VpkwZOyVwioJoqXEmk6nAiKurqxWbWfz4448jRoy4djwpKendd991c3MDUlNTPT3PwE+FSpuenu7q6nrdSW0rOzs7PT3dsjextytXrpQpU8bFxe5HlLOzszMyMtzd3e09EZCWlubu7n71N8ytyM52HzRokOVjV1fX/fv3W15euXLF0/MMDCrUu2VkZAD2+wG+2uXLlz08PBwwUXp6uouLi+WHyK7MZnNaWprDvigrfq5dXFxCQkIs32MXLlwALN8tZrO5fHlTdnbhvluysrKysrLKli1bqL9lncuXL5crV66wPx1WyMzMzM7OdtgX5ZjvFqt/rj/88EPL3u/ixYuurq55u5rs7GxPz9cK9VZms/nKlSv6H4TV0tLSypYt64Avyuqf688+i9m8eTOQmZmZmJiY991ytf/85z8tW7a0QcrrMjuBX375Bdi9e3feyIwZM9zd3a3bzN6efPLJ8PBwB0y0Z8+eJk2aOGAis9n86KOPfvPNNw6YaPPmzR06dHDARGazuVGjRr/88otj5rqRsWPHjh071gETXbx40dPT0wETmc3moUOHzpo1ywETRUVF1ahRwwETmR34c30T4eHhTz75pGPmqlGjRlRUlAMmmjVr1tChQx0wkdls9vT0vHjxogMmctjP9U388ssvjRo1csxcHTp02Lx5swMm+uabbx599FEHTGQ2m5s0abJnzx4HTOTIn2vbcoprEKtVq2YymY4fP543EhkZGRAQYN1mIiIiIlIUTlEQfX19W7duvXbtWsvLzMzMjRs3BgcHW7eZiIiIiBSFUxREICQkZN26dRMmTNi5c2ffvn2vPt0eGhr69NNPX7ly5eabiYiIiIhNOEtB7NixY3h4+MaNG4OCguLi4rZu3VqrVs6KQ3v27AkPD8/MzLz5ZiIiIiJiE05xF7NFcHDwdc8Xh4WFhYWF/e1mIiIiImITTlQQixEHPBvCYbM4eLoS+UU5Q4AS+S+2RH5RzhNA/xGdfBanylAi/8WWyC/Khkzmax4lLTd38ODBatWq+fr62nuiK1eu7N+/v3nz5vaeCIiIiAgMDPTy8rL3RKmpqZGRkffdd5+9JwJ++OGHJk2aOOYBbDcSFRUF1KxZ0wFzbd++/eGHH3bARMeOHfP29vb397f3RFlZWT/88MNDDz1k74lw4M/1TVy4cOGPP/5o1KiRA+basWNHixYtHPA817Nnz6akpNSrV8/eE+HAHwFH/lzfSHp6ekRERIsWLRww1759+/7xj39UqFDB3hNdvHjx6NGjTZo0sfdEwO7du++9914HPHPRkT/XtqWCKCIiIiL5OMtNKiIiIiLiJFQQRURERCQfFUQRERERyUcFUURERETyUUEUERERkXxUEAtt1qxZzZs3r1ChQv369adNm2ZZ4sXeNm3atGbNGvu9/6+//tq9e/dKlSrVrl175syZ9psoMzNzypQpdevWLV++/P33379y5Urbvv+WLVvWr19fYHDVqlXNmjXz8fF59NFHDxw4YNsZRWzI8bsXe+9bcNTuRfsWERszS2G88847wMiRIzds2DBq1Cg3N7cxY8bYe9Jff/3V09PzmWeesdP7Hz9+vEqVKh07dly5cuWoUaOAJUuW2Gmut956y93d/d13392wYcPgwYOBjRs32urNs7KymjVrFhIScvXghg0bTCbTkCFDVqxY0aFDBy8vr9OnT9tqRhEbcvzuxd77FrMDdy/at4jYlgpiIVy5csXb23v48OF5I6+88oqHh0dmZqb9Jk1PT7///vsB++3EhwwZ0rBhwytXrlhePvTQQy1atLDTXHfccceIESPyXjZt2jQ4OLjobxsdHT179uxWrVoBBXbirVu37tChg+XjS5cuVa9e/Y033ij6jCK25fjdiwP2LWYH7l60bxGxLZ1iLoQzZ86kpKR06tQpbwsUbEkAAAnwSURBVOTBBx+8fPny6dOn7TfpmDFjXF1dLftxe8jIyFi+fHmfPn3yVhxZsWLF3Llz7TddxYoV815Wrlw5LS2t6G978ODBZcuWZWdnlytX7urxxMTEbdu29ejRw/LSw8MjKCho2bJlRZ9RxLYcv3ux974Fx+5etG8RsS0VxEKoVq3aiRMnLL9KWuzcudPDw8N+a45t37599uzZixcvLlOmjJ2mOHPmzIULF5o2bZqZmXn48OFz5875+fnZb1Ggxx9/PDQ09KeffkpISAgNDf36668ff/zxor9tx44dd+zYsWPHjoCAgKvHY2JigMDAwLyRwMDAqKio9PT0ok8qYkMO3r04YN+CY3cv2reI2JYKYiG4u7vXrl07b+nGpUuXzpw588UXXyzwm6WtJCUl9enTZ+rUqXXr1rXH+1vExcUBP/zwg6+vb8OGDf38/Dp06GAZtIcZM2b4+/s/8MADlSpVGjRo0IABA/r162enuYDY2Fjg6uMKvr6+ZrM5JSXFfpOKWMGRuxfH7Ftw7O5F+xYR21JBtEZ8fHyfPn2eeeaZZ555ZvLkyXaaZfDgwXfddZflamv7uXDhAjBr1qxVq1alpqZu37790KFDzz//vJ2mGzp0aExMzMcff/z9999Pnjx58eLFYWFhdpoLMJvNgMlkKjDi6upqv0lFisIBuxfH7Ftw7O5F+xYR23IzOkDxs2nTpmeffdbLy2vt2rVdu3a10yzh4eFbtmw5dOiQnd4/j+U34EmTJrVr1w5o1arVW2+9NWTIkKSkJB8fH9vOdezYsbCwsK+++soy1z//+c+srKzRo0c/99xzLi52+V3Fz88PSEpKyhtJSkpyd3e/+vd+EefhgN2Lw/YtOHD3on2LiM3pCGLhbNq0qUuXLsHBwUeOHLFfOwR+/PHHhIQEf39/k8lkMpl27969ZMkSk8m0bt06205UtWpVoFatWnkjNWvWBOLj4207EfDTTz8B9913X95IkyZNEhISTp48afO5LKpVq2YymY4fP543EhkZWeBaIhEn4Zjdi8P2LThw96J9i4jNqSAWQmZm5oABA3r27Dl79mw7XXeYZ8iQIVuuEhgY2KZNmy1btrRo0cK2E9WqVatBgwZfffVV3si2bdsqVKhQu3Zt204E1KtXD9i5c2feyM6dO8uVK1ejRg2bz2Xh6+vbunXrtWvXWl5mZmZu3LgxODjYTtOJWM1huxeH7Vtw4O5F+xYRm9Mp5kL47rvvYmJi/P39Fy1adPX4k08+afMdet26da++fvy2227z9/dv06aNbWexePvtt3v37m0ymR566KEdO3ZMnz596tSp9jgv06xZs8cee6x///5jx46tW7fujh073n///bffftuu91GGhIR07tx5woQJbdq0mTNnTmJi4qBBg+w3nYh1HLZ7ceS+BUftXrRvEbE9Ix/CWNzc6PFdsbGx9p66efPmdn2Y7bJly5o1a1a+fPnGjRsvXLjQfhNdvHhx9OjRdevW9fLyaty4cVhYWHZ2tg3fv06dOgUeZms2m1esWNGsWbPbbrutTZs2+/fvt+F0IrZi1O7F3vsWs6N2L9q3iNiWyWw227N/ioiIiEgxo2sQRURERCQfFUQRERERyUcFUURERETyUUEUERERkXxUEEVEREQkHxVEEREREclHBVFERERE8lFBFBEREZF8VBBFREREJB8VRBERERHJRwVRRERERPJRQRQRERGRfFQQRURERCQfFUQRERERyUcFUURERETyUUEUkVLt5ZdfNl3PmDFjjI4mImIYN6MDiIgYrEKFCh9//HGBwfr16xsSRkTEGaggikhp5+7u/vjjjxflHdLT000mU5kyZW6+mdlszs7OdnV1LcpcIiIOoFPMIiI34+HhsXTp0ryXzz77bOfOnS0f+/v7f/bZZ6+++mrVqlVjYmKys7MnTZp01113eXt7N2/efMOGDZbNfvvtN5PJ9MUXX9SsWbNMmTKBgYHvv//+1VMsWrSoSZMmXl5eDRs2vPZYpoiI46kgiohYb+rUqZGRkaGhoX5+fsOHD584cWLv3r2XLVvWoEGDzp07r1+/Pm/L7t27t2/ffs2aNZ06dRo1atS4ceMs4zNnzhwwYEBQUNDKlSvbtWv33HPPffTRR8Z8MSIiuXSKWURKu/Pnz5tMpgKDX3zxRfv27f/276anp69Zs8ZkMp05c2bevHnTp08fNmwYEBQUdO7cuXHjxnXp0sWy5WOPPRYaGgp07drVZDJNnz79lVdecXFxGT9+/Ntvv/3WW28BHTt2vHjx4rhx44YMGWLjL1JEpDBUEEWktLvuTSqNGze+lb/bsWNHS7ncv39/ZmbmE088kfepJ5544tlnn01PT7e8fPrpp/M+1adPn6lTpx49ehRISEho06ZNQkKC5VOtWrUKCwuLjo6uXr16Eb4mEZEiUUEUkdKuKDep+Pn5WT6IiYlxcXGpUqVK3qfuuOOO7Ozs2NhYy8uqVavmfSogIACIjo7OysoCWrRoUeBtk5KSVBBFxEC6BlFEpBCSkpKufunikrMXtdTB+Pj4vE/FxcWZTKa8ypjXFIGzZ88C/v7+lStXBs6dO2fOr1GjRvb+QkREbkIFUUTkZlxcXE6cOGH5+NKlSz/88MN1N2vcuLGbm9uKFSvyRj777LNGjRqVK1cu72Xep5YsWeLp6dmgQYOGDRu6u7t//vnneZ96++2327Zta/svQ0SkMHSKWURKuytXrqxbt67AoI+Pz8MPPwzcfffd8+bNq1WrVo0aNd59993z589f902qV68+cODAV199NS0trWHDhqtWrVq/fv3atWvzNli/fv3QoUODgoK+//77KVOmjBo1ysfHBxgxYsSQIUPOnj173333bdu2bdq0af/5z3/s9rWKiNwSFUQRKe1SU1O7detWYLBJkyZ79uwB/ve//w0ePHjw4MGXL19u0qTJCy+8EBUVdd33mTFjRtWqVRcsWBAdHd2gQYP169fnPTERWLZs2fz583v16lWlSpWJEyeOGjXKMv7uu+9Wrlx54cKFkydPrlmz5kcffTRo0CC7fJ0iIrfMZDabjc4gIuLszGZzfHz81feg3LrffvutTp06ERER999/v82DiYjYg65BFBH5e1ffbiIiUuKpIIqIiIhIPjrFLCJiX5mZmX/88Ye/v3/ZsmWNziIicktUEEVEREQkH51iFhEREZF8VBBFREREJB8VRBERERHJRwVRRERERPJRQRQRERGRfFQQRURERCQfFUQRERERyUcFUURERETyUUEUERERkXxUEEVEREQkHxVEEREREclHBVFERERE8lFBFBEREZF8VBBFREREJB8VRBERERHJRwVRRERERPJRQRQRERGRfFQQRUREROT/261jAQAAAIBB/ta751AUjSACADABg5apVSoWz98AAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
<p>To cross-validate this multinomial-logit model we need an appropriate
cost criterion. None of the criteria supplied by the <strong>cv</strong>
package—for example, neither <code>mse()</code>, which is appropriate
for a numeric response, nor <code>BayesRule()</code>, which is
appropriate for a binary response—will do. One possibility is to adapt
Bayes rule to a polytomous response:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">head</span>(BEPS<span class="sc">$</span>vote)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; [1] Liberal Democrat Labour           Labour           Labour          </span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; [5] Labour           Labour          </span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; Levels: Conservative Labour Liberal Democrat</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(m.beps, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="fu">head</span>(yhat)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; [1] Labour           Labour           Labour           Labour          </span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; [5] Liberal Democrat Labour          </span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; Levels: Conservative Labour Liberal Democrat</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>BayesRuleMulti <span class="ot">&lt;-</span> <span class="cf">function</span>(y, yhat) {</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">mean</span>(y <span class="sc">!=</span> yhat)</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  <span class="fu">attr</span>(result, <span class="st">&quot;casewise loss&quot;</span>) <span class="ot">&lt;-</span> <span class="st">&quot;y != yhat&quot;</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>  result</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>}</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="fu">BayesRuleMulti</span>(BEPS<span class="sc">$</span>vote, yhat)</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; [1] 0.31869</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;casewise loss&quot;)</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; [1] &quot;y != yhat&quot;</span></span></code></pre></div>
<p>The <code>predict()</code> method for <code>&quot;multinom&quot;</code> models
called with argument <code>type=&quot;class&quot;</code> reports the Bayes-rule
prediction for each case—that is, the response category with the highest
predicted probability. Our <code>BayesRuleMulti()</code> function
calculates the proportion of misclassified cases. Because this value is
the mean of casewise components, we attach a
<code>&quot;casewise loss&quot;</code> attribute to the result (as explained in
the preceding section).</p>
<p>The marginal proportions for the response categories are</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span> vote, <span class="at">data=</span>BEPS)<span class="sc">/</span><span class="fu">nrow</span>(BEPS)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; vote</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt;     Conservative           Labour Liberal Democrat </span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt;          0.30295          0.47213          0.22492</span></span></code></pre></div>
<p>and so the marginal Bayes-rule prediction, that everyone will vote
Labour, produces an error rate of <span class="math inline">\(1 -
0.47213 = 0.52787\)</span>. The multinomial-logit model appears to do
substantially better than that, but does its performance hold up to
cross-validation?</p>
<p>We check first whether the default <code>cv()</code> method works
“out-of-the-box” for the <code>&quot;multinom&quot;</code> model:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">cv</span>(m.beps, <span class="at">seed=</span><span class="dv">3465</span>, <span class="at">criterion=</span>BayesRuleMulti)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; Error in GetResponse.default(model): non-vector response</span></span></code></pre></div>
<p>The default method of <code>GetResponse()</code> (a function supplied
by the <strong>cv</strong> package—see <code>?GetResponse</code>) fails
for a <code>&quot;multinom&quot;</code> object. A straightforward solution is to
supply a <code>GetResponse.multinom()</code> method that returns the
factor response <span class="citation">(using the
<code>get_response()</code> function from the <strong>insight</strong>
package, Lüdecke, Waggoner, &amp; Makowski, 2019)</span>,</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>GetResponse.multinom <span class="ot">&lt;-</span> <span class="cf">function</span>(model, ...) {</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  insight<span class="sc">::</span><span class="fu">get_response</span>(model)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>}</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">GetResponse</span>(m.beps))</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; [1] Liberal Democrat Labour           Labour           Labour          </span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; [5] Labour           Labour          </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; Levels: Conservative Labour Liberal Democrat</span></span></code></pre></div>
<p>and to try again:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">cv</span>(m.beps, <span class="at">seed=</span><span class="dv">3465</span>, <span class="at">criterion=</span>BayesRuleMulti)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; R RNG seed set to 3465</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; # weights:  36 (22 variable)</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; initial  value 1507.296060 </span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; iter  10 value 1134.575036</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; iter  20 value 1037.413231</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; iter  30 value 1007.705242</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; iter  30 value 1007.705235</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; iter  30 value 1007.705235</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; final  value 1007.705235 </span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; converged</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; Error in match.arg(type): &#39;arg&#39; should be one of &quot;class&quot;, &quot;probs&quot;</span></span></code></pre></div>
<p>A <code>traceback()</code> (not shown) reveals that the problem is
that the default method of <code>cv()</code> calls the
<code>&quot;multinom&quot;</code> method for <code>predict()</code> with the
argument <code>type=&quot;response&quot;</code>, when the correct argument should
be <code>type=&quot;class&quot;</code>. We therefore must write a
“<code>multinom</code>” method for <code>cv()</code>, but that proves to
be very simple:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>cv.multinom <span class="ot">&lt;-</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="cf">function</span> (model, data, <span class="at">criterion =</span> BayesRuleMulti, k, reps,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>            seed, ...) {</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">update</span>(model, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    <span class="fu">NextMethod</span>(</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">&quot;class&quot;</span>,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>      <span class="at">criterion =</span> criterion,</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>      <span class="at">criterion.name =</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(criterion))</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    )</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  }</span></code></pre></div>
<p>That is, we simply call the default <code>cv()</code> method with the
<code>type</code> argument properly set. In addition to supplying the
correct <code>type</code> argument, our method sets the default
<code>criterion</code> for the <code>cv.multinom()</code> method to
<code>BayesRuleMulti</code>. Adding the argument
<code>criterion.name=deparse(substitute(criterion))</code> is
inessential, but it insures that printed output will include the name of
the criterion function that’s employed, whether it’s the default
<code>BayesRuleMulti</code> or something else. Prior to invoking
<code>NextMethod()</code>, we called <code>update()</code> with
<code>trace=FALSE</code> to suppress the iteration history reported by
default by <code>multinom()</code>—it would be tedious to see the
iteration history for each fold.</p>
<p>Then:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">cv</span>(m.beps, <span class="at">seed=</span><span class="dv">3465</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; R RNG seed set to 3465</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; 10-Fold Cross Validation</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt; criterion: BayesRuleMulti</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; cross-validation criterion = 0.32459</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; bias-adjusted cross-validation criterion = 0.32368</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; 95% CI for bias-adjusted CV criterion = (0.30017, 0.34718)</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; full-sample criterion = 0.31869</span></span></code></pre></div>
<p>The cross-validated polytomous Bayes-rule criterion confirms that the
fitted model does substantially better than the marginal Bayes-rule
prediction that everyone votes for Labour.</p>
<div id="calling-cvcompute" class="section level4">
<h4>Calling cvCompute()</h4>
<p><code>cv()</code> methods for independently sampled cases, such as
<code>cv.default()</code>, <code>cv.lm()</code>, and
<code>cv.glm()</code>, work by setting up calls to the
<code>cvCompute()</code> function, which is exported from the
<strong>cv</strong> package to support development of <code>cv()</code>
methods for additional classes of regression models. In most cases,
however, such as the preceding <code>cv.multinom()</code> example, it
will suffice and be much simpler to set up a suitable call to
<code>cv.default()</code> via <code>NextMethod()</code>.</p>
<p>To illustrate how to use <code>cvCompute()</code> directly, we write
an alternative, and necessarily more complicated, version of
<code>cv.multinom()</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>cv.multinom <span class="ot">&lt;-</span> <span class="cf">function</span>(model,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>                        <span class="at">data =</span> insight<span class="sc">::</span><span class="fu">get_data</span>(model),</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                        <span class="at">criterion =</span> BayesRuleMulti,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>                        <span class="at">k =</span> <span class="dv">10</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>                        <span class="at">reps =</span> <span class="dv">1</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>                        <span class="at">seed =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                        <span class="at">details =</span> k <span class="sc">&lt;=</span> <span class="dv">10</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>                        <span class="at">confint =</span> n <span class="sc">&gt;=</span> <span class="dv">400</span>,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>                        <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>                        <span class="at">ncores =</span> <span class="dv">1</span>,</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>                        <span class="at">start =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>                        ...) {</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>    <span class="co"># helper function to compute to compute fitted values,</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>    <span class="co">#  etc., for each fold i</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>    </span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>    indices.i <span class="ot">&lt;-</span> <span class="fu">fold</span>(folds, i)</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>    model.i <span class="ot">&lt;-</span> <span class="cf">if</span> (start) {</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>      <span class="fu">update</span>(model,</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>             <span class="at">data =</span> data[<span class="sc">-</span>indices.i,],</span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>             <span class="at">start =</span> b,</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>             <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>      <span class="fu">update</span>(model, <span class="at">data =</span> data[<span class="sc">-</span>indices.i,], <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>    }</span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>    fit.all.i <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.i, <span class="at">newdata =</span> data, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>    fit.i <span class="ot">&lt;-</span> fit.all.i[indices.i]</span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>    <span class="co"># returns:</span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>    <span class="co">#  fit.i: fitted values for the i-th fold</span></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a>    <span class="co">#  crit.all.i: CV criterion for all cases based on model with</span></span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a>    <span class="co">#              i-th fold omitted</span></span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a>    <span class="co">#  coef.i: coefficients for the model with i-th fold omitted</span></span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a>      <span class="at">fit.i =</span> fit.i,</span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a>      <span class="at">crit.all.i =</span> <span class="fu">criterion</span>(y, fit.all.i),</span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a>      <span class="at">coef.i =</span> <span class="fu">coef</span>(model.i)</span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a>    )</span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a>  }</span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a>  </span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a>  fPara <span class="ot">&lt;-</span> <span class="cf">function</span>(i, multinom, ...) {</span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a>    <span class="co"># helper function for parallel computation</span></span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a>    <span class="co">#   argument multinom makes multinom() locally available</span></span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a>    <span class="co">#   ... is necessary but not used</span></span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a>    indices.i <span class="ot">&lt;-</span> <span class="fu">fold</span>(folds, i)</span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a>    model.i <span class="ot">&lt;-</span> <span class="cf">if</span> (start) {</span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a>      <span class="fu">update</span>(model,</span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a>             <span class="at">data =</span> data[<span class="sc">-</span>indices.i,],</span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a>             <span class="at">start =</span> b,</span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a>             <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-50"><a href="#cb15-50" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb15-51"><a href="#cb15-51" tabindex="-1"></a>      <span class="fu">update</span>(model, <span class="at">data =</span> data[<span class="sc">-</span>indices.i,], <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-52"><a href="#cb15-52" tabindex="-1"></a>    }</span>
<span id="cb15-53"><a href="#cb15-53" tabindex="-1"></a>    fit.all.i <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.i, <span class="at">newdata =</span> data, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb15-54"><a href="#cb15-54" tabindex="-1"></a>    fit.i <span class="ot">&lt;-</span> fit.all.i[indices.i]</span>
<span id="cb15-55"><a href="#cb15-55" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb15-56"><a href="#cb15-56" tabindex="-1"></a>      <span class="at">fit.i =</span> fit.i,</span>
<span id="cb15-57"><a href="#cb15-57" tabindex="-1"></a>      <span class="at">crit.all.i =</span> <span class="fu">criterion</span>(y, fit.all.i),</span>
<span id="cb15-58"><a href="#cb15-58" tabindex="-1"></a>      <span class="at">coef.i =</span> <span class="fu">coef</span>(model.i)</span>
<span id="cb15-59"><a href="#cb15-59" tabindex="-1"></a>    )</span>
<span id="cb15-60"><a href="#cb15-60" tabindex="-1"></a>  }</span>
<span id="cb15-61"><a href="#cb15-61" tabindex="-1"></a>  </span>
<span id="cb15-62"><a href="#cb15-62" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb15-63"><a href="#cb15-63" tabindex="-1"></a>  </span>
<span id="cb15-64"><a href="#cb15-64" tabindex="-1"></a>  <span class="co"># see ?cvCompute for definitions of arguments</span></span>
<span id="cb15-65"><a href="#cb15-65" tabindex="-1"></a>  <span class="fu">cvCompute</span>(</span>
<span id="cb15-66"><a href="#cb15-66" tabindex="-1"></a>    <span class="at">model =</span> model,</span>
<span id="cb15-67"><a href="#cb15-67" tabindex="-1"></a>    <span class="at">data =</span> data,</span>
<span id="cb15-68"><a href="#cb15-68" tabindex="-1"></a>    <span class="at">criterion =</span> criterion,</span>
<span id="cb15-69"><a href="#cb15-69" tabindex="-1"></a>    <span class="at">criterion.name =</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(criterion)),</span>
<span id="cb15-70"><a href="#cb15-70" tabindex="-1"></a>    <span class="at">k =</span> k,</span>
<span id="cb15-71"><a href="#cb15-71" tabindex="-1"></a>    <span class="at">reps =</span> reps,</span>
<span id="cb15-72"><a href="#cb15-72" tabindex="-1"></a>    <span class="at">seed =</span> seed,</span>
<span id="cb15-73"><a href="#cb15-73" tabindex="-1"></a>    <span class="at">details =</span> details,</span>
<span id="cb15-74"><a href="#cb15-74" tabindex="-1"></a>    <span class="at">confint =</span> confint,</span>
<span id="cb15-75"><a href="#cb15-75" tabindex="-1"></a>    <span class="at">level =</span> level,</span>
<span id="cb15-76"><a href="#cb15-76" tabindex="-1"></a>    <span class="at">ncores =</span> ncores,</span>
<span id="cb15-77"><a href="#cb15-77" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;class&quot;</span>,</span>
<span id="cb15-78"><a href="#cb15-78" tabindex="-1"></a>    <span class="at">start =</span> start,</span>
<span id="cb15-79"><a href="#cb15-79" tabindex="-1"></a>    <span class="at">f =</span> f,</span>
<span id="cb15-80"><a href="#cb15-80" tabindex="-1"></a>    <span class="at">fPara =</span> fPara,</span>
<span id="cb15-81"><a href="#cb15-81" tabindex="-1"></a>    <span class="at">multinom =</span> nnet<span class="sc">::</span>multinom</span>
<span id="cb15-82"><a href="#cb15-82" tabindex="-1"></a>  )</span>
<span id="cb15-83"><a href="#cb15-83" tabindex="-1"></a>}</span></code></pre></div>
<p>Notice that separate “helper” functions are defined for non-parallel
and parallel computations.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> The new version of
<code>cv.multinom()</code> produces the same results as the version that
calls <code>cv.default()</code>:<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">cv</span>(m.beps, <span class="at">seed=</span><span class="dv">3465</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co">#&gt; R RNG seed set to 3465</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt; 10-Fold Cross Validation</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; criterion: BayesRuleMulti</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; cross-validation criterion = 0.32459</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; bias-adjusted cross-validation criterion = 0.32368</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; 95% CI for bias-adjusted CV criterion = (0.30017, 0.34718)</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt; full-sample criterion = 0.31869</span></span></code></pre></div>
</div>
</div>
<div id="mixed-effects-models" class="section level3">
<h3>Mixed-effects models</h3>
<p>Adding a <code>cv()</code> method for a mixed-model class is somewhat
more complicated. We provide the <code>cvMixed()</code> function to
facilitate this process, and to see how that works, consider the
<code>&quot;lme&quot;</code> method from the <strong>cv</strong> package:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>cv<span class="sc">:::</span>cv.lme</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt; function (model, data = insight::get_data(model), criterion = mse, </span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt;     k = NULL, reps = 1L, seed, details = NULL, ncores = 1L, clusterVariables, </span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt;     blups = coef, fixed.effects = nlme::fixef, ...) </span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt;     cvMixed(model, package = &quot;nlme&quot;, data = data, criterion = criterion, </span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt;         criterion.name = deparse(substitute(criterion)), k = k, </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt;         reps = reps, seed = seed, details = details, ncores = ncores, </span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt;         clusterVariables = clusterVariables, predict.clusters.args = list(object = model, </span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt;             newdata = data, level = 0), predict.cases.args = list(object = model, </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt;             newdata = data, level = 1), blups = blups, fixed.effects = fixed.effects, </span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt;         ...)</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; &lt;bytecode: 0x63a6fccaa7a0&gt;</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; &lt;environment: namespace:cv&gt;</span></span></code></pre></div>
<p>Notice that <code>cv.lme()</code> sets up a call to
<code>cvMixed()</code>, which does the computational work.</p>
<p>Most of the arguments of <code>cvMixed()</code> are familiar:</p>
<ul>
<li><p><code>model</code> is the mixed-model object, here of class
<code>&quot;lme&quot;</code>.</p></li>
<li><p><code>package</code> is the name of the package in which the
mixed-modeling function used to fit the model, here <code>lme()</code>,
resides—i.e., <code>&quot;nlme&quot;</code>; <code>cvMixed()</code> uses this
argument to retrieve the package namespace.</p></li>
<li><p><code>data</code> is the data set to which the model is fit, by
default extracted by the <code>get_data()</code> function in the
<strong>insight</strong> package.</p></li>
<li><p><code>criterion</code> is the CV criterion, defaulting to the
<code>mse()</code> function.</p></li>
<li><p><code>k</code> is the number of CV folds, defaulting to
<code>&quot;loo&quot;</code> for CV by clusters and <code>10</code> for CV by
cases.</p></li>
<li><p><code>reps</code> is the number of times the CV process is
repeated, defaulting to <code>1</code>.</p></li>
<li><p><code>seed</code> is the seed for R’s random-number generator,
defaulting to a randomly selected (and saved) value.</p></li>
<li><p><code>ncores</code> is the number of cores to use for parallel
computation; if <code>1</code>, the default, then the computation isn’t
parallelized.</p></li>
<li><p><code>clusterVariables</code> is a character vector of the names
of variables defining clusters; if missing, then CV is based on cases
rather than clusters.</p></li>
</ul>
<p>The remaining two arguments are unfamiliar:</p>
<ul>
<li><p><code>predict.clusters.args</code> is a named list of arguments
to be passed to the <code>predict()</code> function to obtain
predictions for the full data set from a model fit to a subset of the
data for cluster-based CV. The first two arguments should be
<code>object</code> and <code>newdata</code>. It is typically necessary
to tell <code>cvMixed()</code> how to base predictions only on fixed
effects; in the case of <code>&quot;lme&quot;</code> models, this is done by
setting <code>level = 0</code>.</p></li>
<li><p>Similarly, <code>predict.cases.args</code> is a named list of
arguments to be passed to <code>predict()</code> for case-based CV.
Setting <code>level = 1</code> includes random effects in the
predictions.</p></li>
<li><p><code>blups</code> and <code>fixed.effects</code> are used to
compute detailed fold-based statistics for case-based and cluster-based
CV, respectively.</p></li>
</ul>
<p>Finally, any additional arguments, absorbed by <code>...</code>, are
passed to <code>update()</code> when the model is refit with each fold
omitted. <code>cvMixed()</code> returns an object of class
<code>&quot;cv&quot;</code>.</p>
<p>Now imagine that we want to support a new class of mixed-effects
models. To be concrete, we illustrate with the <code>glmmPQL()</code>
function in the <strong>MASS</strong> package <span class="citation">(Venables &amp; Ripley, 2002)</span>, which fits
generalized-linear mixed-effects models by penalized quasi-likelihood.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> Not
coincidentally, the arguments of <code>glmmPQL()</code> are similar to
those of <code>lme()</code> (with an additional <code>family</code>
argument), because the former iteratively invokes the latter; so
<code>cv.glmmPQL()</code> should resemble <code>cv.lme()</code>.</p>
<p>As it turns out, neither the default method for
<code>GetResponse()</code> nor <code>insight::get_data()</code> work for
<code>&quot;glmmPQL&quot;</code> objects. These objects include a
<code>&quot;data&quot;</code> element, however, and so we can simply extract this
element as the default for the <code>data</code> argument of our
<code>cv.glmmPQL()</code> method.</p>
<p>To get the response variable is more complicated: We refit the fixed
part of the model as a GLM with only the regression constant on the
right-hand side, and extract the response from that; because all we need
is the response variable, we limit the number of GLM iterations to 1 and
suppress warning messages about non-convergence:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>GetResponse.glmmPQL <span class="ot">&lt;-</span> <span class="cf">function</span>(model, ...) {</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">formula</span>(model)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  f[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># regression constant only on RHS</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  model <span class="ot">&lt;-</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>    <span class="fu">suppressWarnings</span>(<span class="fu">glm</span>(</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>      f,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>      <span class="at">data =</span> model<span class="sc">$</span>data,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>      <span class="at">family =</span> model<span class="sc">$</span>family,</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">1</span>)</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>    ))</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>  cv<span class="sc">::</span><span class="fu">GetResponse</span>(model)</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>}</span></code></pre></div>
<p>Writing the <code>cv()</code> method is then straightforward:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>cv.glmmPQL <span class="ot">&lt;-</span> <span class="cf">function</span>(model,</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>                       <span class="at">data =</span> model<span class="sc">$</span>data,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>                       <span class="at">criterion =</span> mse,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>                       k,</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>                       <span class="at">reps =</span> <span class="dv">1</span>,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                       seed,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>                       <span class="at">ncores =</span> <span class="dv">1</span>,</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>                       clusterVariables,</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>                       <span class="at">blups =</span> coef,</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>                       <span class="at">fixed.effects =</span> nlme<span class="sc">::</span>fixef,</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>                       ...) {</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>  <span class="fu">cvMixed</span>(</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>    model,</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>    <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>,</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>    <span class="at">data =</span> data,</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>    <span class="at">criterion =</span> criterion,</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>    <span class="at">k =</span> k,</span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>    <span class="at">reps =</span> reps,</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>    <span class="at">seed =</span> seed,</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>    <span class="at">ncores =</span> ncores,</span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>    <span class="at">clusterVariables =</span> clusterVariables,</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>    <span class="at">predict.clusters.args =</span> <span class="fu">list</span>(</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>      <span class="at">object =</span> model,</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>      <span class="at">newdata =</span> data,</span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>      <span class="at">level =</span> <span class="dv">0</span>,</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a>    ),</span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a>    <span class="at">predict.cases.args =</span> <span class="fu">list</span>(</span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a>      <span class="at">object =</span> model,</span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a>      <span class="at">newdata =</span> data,</span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a>      <span class="at">level =</span> <span class="dv">1</span>,</span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a>    ),</span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a>    <span class="at">blups =</span> blups,</span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a>    <span class="at">fixed.effects =</span> fixed.effects,</span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a>    ...</span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a>  )</span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a>}</span></code></pre></div>
<p>We set the argument <code>verbose=FALSE</code> to suppress
<code>glmmPQL()</code>’s iteration counter when <code>cvMixed()</code>
calls <code>update()</code>.</p>
<p>Let’s apply our newly minted method to a logistic regression with a
random intercept in an example that appears in
<code>?glmmPQL</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>m.pql <span class="ot">&lt;-</span> <span class="fu">glmmPQL</span>(</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  y <span class="sc">~</span> trt <span class="sc">+</span> <span class="fu">I</span>(week <span class="sc">&gt;</span> <span class="dv">2</span>),</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> ID,</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="at">data =</span> bacteria</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; iteration 1</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; iteration 2</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt; iteration 3</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; iteration 4</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt; iteration 5</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co">#&gt; iteration 6</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="fu">summary</span>(m.pql)</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co">#&gt; Linear mixed-effects model fit by maximum likelihood</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co">#&gt;   Data: bacteria </span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co">#&gt;   AIC BIC logLik</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">#&gt;    NA  NA     NA</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="co">#&gt;  Formula: ~1 | ID</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a><span class="co">#&gt;         (Intercept) Residual</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="co">#&gt; StdDev:      1.4106  0.78005</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a><span class="co">#&gt; Variance function:</span></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="co">#&gt;  Structure: fixed weights</span></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a><span class="co">#&gt;  Formula: ~invwt </span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a><span class="co">#&gt; Fixed effects:  y ~ trt + I(week &gt; 2) </span></span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a><span class="co">#&gt;                   Value Std.Error  DF t-value p-value</span></span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a><span class="co">#&gt; (Intercept)      3.4120   0.51850 169  6.5805  0.0000</span></span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a><span class="co">#&gt; trtdrug         -1.2474   0.64406  47 -1.9367  0.0588</span></span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a><span class="co">#&gt; trtdrug+        -0.7543   0.64540  47 -1.1688  0.2484</span></span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a><span class="co">#&gt; I(week &gt; 2)TRUE -1.6073   0.35834 169 -4.4853  0.0000</span></span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a><span class="co">#&gt;  Correlation: </span></span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a><span class="co">#&gt;                 (Intr) trtdrg trtdr+</span></span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a><span class="co">#&gt; trtdrug         -0.598              </span></span>
<span id="cb21-37"><a href="#cb21-37" tabindex="-1"></a><span class="co">#&gt; trtdrug+        -0.571  0.460       </span></span>
<span id="cb21-38"><a href="#cb21-38" tabindex="-1"></a><span class="co">#&gt; I(week &gt; 2)TRUE -0.537  0.047 -0.001</span></span>
<span id="cb21-39"><a href="#cb21-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-40"><a href="#cb21-40" tabindex="-1"></a><span class="co">#&gt; Standardized Within-Group Residuals:</span></span>
<span id="cb21-41"><a href="#cb21-41" tabindex="-1"></a><span class="co">#&gt;      Min       Q1      Med       Q3      Max </span></span>
<span id="cb21-42"><a href="#cb21-42" tabindex="-1"></a><span class="co">#&gt; -5.19854  0.15723  0.35131  0.49495  1.74488 </span></span>
<span id="cb21-43"><a href="#cb21-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-44"><a href="#cb21-44" tabindex="-1"></a><span class="co">#&gt; Number of Observations: 220</span></span>
<span id="cb21-45"><a href="#cb21-45" tabindex="-1"></a><span class="co">#&gt; Number of Groups: 50</span></span></code></pre></div>
<p>We compare this result to that obtained from <code>glmer()</code> in
the <strong>lme4</strong> package:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lme4&quot;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: Matrix</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>m.glmer <span class="ot">&lt;-</span> <span class="fu">glmer</span>(y <span class="sc">~</span> trt <span class="sc">+</span> <span class="fu">I</span>(week <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>                 <span class="at">family =</span> binomial, <span class="at">data =</span> bacteria)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="fu">summary</span>(m.glmer)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co">#&gt; Generalized linear mixed model fit by maximum likelihood (Laplace</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co">#&gt;   Approximation) [glmerMod]</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co">#&gt;  Family: binomial  ( logit )</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt; Formula: y ~ trt + I(week &gt; 2) + (1 | ID)</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt;    Data: bacteria</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt;    202.3    219.2    -96.1    192.3      215 </span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co">#&gt; Scaled residuals: </span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="co">#&gt; -4.561  0.136  0.302  0.422  1.128 </span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co">#&gt;  Groups Name        Variance Std.Dev.</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co">#&gt;  ID     (Intercept) 1.54     1.24    </span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="co">#&gt; Number of obs: 220, groups:  ID, 50</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a><span class="co">#&gt;                 Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a><span class="co">#&gt; (Intercept)        3.548      0.696    5.10  3.4e-07 ***</span></span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a><span class="co">#&gt; trtdrug           -1.367      0.677   -2.02  0.04352 *  </span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a><span class="co">#&gt; trtdrug+          -0.783      0.683   -1.15  0.25193    </span></span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a><span class="co">#&gt; I(week &gt; 2)TRUE   -1.598      0.476   -3.36  0.00078 ***</span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a><span class="co">#&gt;             (Intr) trtdrg trtdr+</span></span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a><span class="co">#&gt; trtdrug     -0.593              </span></span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a><span class="co">#&gt; trtdrug+    -0.537  0.487       </span></span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a><span class="co">#&gt; I(wk&gt;2)TRUE -0.656  0.126  0.064</span></span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a></span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a><span class="co"># comparison of fixed effects:</span></span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">compareCoefs</span>(m.pql, m.glmer) </span>
<span id="cb22-41"><a href="#cb22-41" tabindex="-1"></a><span class="co">#&gt; Warning in car::compareCoefs(m.pql, m.glmer): models to be compared are of</span></span>
<span id="cb22-42"><a href="#cb22-42" tabindex="-1"></a><span class="co">#&gt; different classes</span></span>
<span id="cb22-43"><a href="#cb22-43" tabindex="-1"></a><span class="co">#&gt; Calls:</span></span>
<span id="cb22-44"><a href="#cb22-44" tabindex="-1"></a><span class="co">#&gt; 1: glmmPQL(fixed = y ~ trt + I(week &gt; 2), random = ~1 | ID, family = </span></span>
<span id="cb22-45"><a href="#cb22-45" tabindex="-1"></a><span class="co">#&gt;   binomial, data = bacteria)</span></span>
<span id="cb22-46"><a href="#cb22-46" tabindex="-1"></a><span class="co">#&gt; 2: glmer(formula = y ~ trt + I(week &gt; 2) + (1 | ID), data = bacteria, </span></span>
<span id="cb22-47"><a href="#cb22-47" tabindex="-1"></a><span class="co">#&gt;   family = binomial)</span></span>
<span id="cb22-48"><a href="#cb22-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-49"><a href="#cb22-49" tabindex="-1"></a><span class="co">#&gt;                 Model 1 Model 2</span></span>
<span id="cb22-50"><a href="#cb22-50" tabindex="-1"></a><span class="co">#&gt; (Intercept)       3.412   3.548</span></span>
<span id="cb22-51"><a href="#cb22-51" tabindex="-1"></a><span class="co">#&gt; SE                0.514   0.696</span></span>
<span id="cb22-52"><a href="#cb22-52" tabindex="-1"></a><span class="co">#&gt;                                </span></span>
<span id="cb22-53"><a href="#cb22-53" tabindex="-1"></a><span class="co">#&gt; trtdrug          -1.247  -1.367</span></span>
<span id="cb22-54"><a href="#cb22-54" tabindex="-1"></a><span class="co">#&gt; SE                0.638   0.677</span></span>
<span id="cb22-55"><a href="#cb22-55" tabindex="-1"></a><span class="co">#&gt;                                </span></span>
<span id="cb22-56"><a href="#cb22-56" tabindex="-1"></a><span class="co">#&gt; trtdrug+         -0.754  -0.783</span></span>
<span id="cb22-57"><a href="#cb22-57" tabindex="-1"></a><span class="co">#&gt; SE                0.640   0.683</span></span>
<span id="cb22-58"><a href="#cb22-58" tabindex="-1"></a><span class="co">#&gt;                                </span></span>
<span id="cb22-59"><a href="#cb22-59" tabindex="-1"></a><span class="co">#&gt; I(week &gt; 2)TRUE  -1.607  -1.598</span></span>
<span id="cb22-60"><a href="#cb22-60" tabindex="-1"></a><span class="co">#&gt; SE                0.355   0.476</span></span>
<span id="cb22-61"><a href="#cb22-61" tabindex="-1"></a><span class="co">#&gt; </span></span></code></pre></div>
<p>The two sets of estimates are similar, but not identical</p>
<p>Finally, we try out our <code>cv.glmmPQL()</code> method,
cross-validating both by clusters and by cases,</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">cv</span>(m.pql, <span class="at">clusterVariables=</span><span class="st">&quot;ID&quot;</span>, <span class="at">criterion=</span>BayesRule)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co">#&gt; n-Fold Cross Validation based on 50 {ID} clusters</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">#&gt; cross-validation criterion = 0.19545</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#&gt; bias-adjusted cross-validation criterion = 0.19545</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt; full-sample criterion = 0.19545</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="fu">cv</span>(m.pql, <span class="at">data=</span>bacteria, <span class="at">criterion=</span>BayesRule, <span class="at">seed=</span><span class="dv">1490</span>)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; R RNG seed set to 1490</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; 10-Fold Cross Validation</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt; cross-validation criterion = 0.20909</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co">#&gt; bias-adjusted cross-validation criterion = 0.20727</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">#&gt; full-sample criterion = 0.14545</span></span></code></pre></div>
<p>and again compare to <code>glmer()</code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">cv</span>(m.glmer, <span class="at">clusterVariables=</span><span class="st">&quot;ID&quot;</span>, <span class="at">criterion=</span>BayesRule)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co">#&gt; n-Fold Cross Validation based on 50 {ID} clusters</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#&gt; criterion: BayesRule</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">#&gt; cross-validation criterion = 0.19545</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co">#&gt; bias-adjusted cross-validation criterion = 0.19545</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="co">#&gt; full-sample criterion = 0.19545</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="fu">cv</span>(m.glmer, <span class="at">data=</span>bacteria, <span class="at">criterion=</span>BayesRule, <span class="at">seed=</span><span class="dv">1490</span>)</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="co">#&gt; R RNG seed set to 1490</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="co">#&gt; 10-Fold Cross Validation</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a><span class="co">#&gt; criterion: BayesRule</span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a><span class="co">#&gt; cross-validation criterion = 0.19545</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a><span class="co">#&gt; bias-adjusted cross-validation criterion = 0.19364</span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a><span class="co">#&gt; full-sample criterion = 0.15</span></span></code></pre></div>
</div>
</div>
<div id="adding-a-model-selection-procedure" class="section level2">
<h2>Adding a model-selection procedure</h2>
<p>The <code>selectStepAIC()</code> function supplied by the
<strong>cv</strong> package, which is based on the
<code>stepAIC()</code> function from the <strong>nnet</strong> package
<span class="citation">(Venables &amp; Ripley, 2002)</span> for stepwise
model selection, is suitable for the <code>procedure</code> argument of
<code>cvSelect()</code>. The use of <code>selectStepAIC()</code> is
illustrated in the vignette on cross-validating model selection.</p>
<p>We’ll employ <code>selectStepAIC()</code> as a “template” for writing
a CV model-selection procedure. To see the code for this function, type
<code>cv::selectStepAIC</code> at the R command prompt, or examine the
sources for the <strong>cv</strong> package at <a href="https://github.com/gmonette/cv" class="uri">https://github.com/gmonette/cv</a> (the code for
<code>selectStepAIC()</code> is in <a href="https://github.com/gmonette/cv/blob/main/R/cv-select.R" class="uri">https://github.com/gmonette/cv/blob/main/R/cv-select.R</a>).</p>
<p>Another approach to model selection is all-subsets regression. The
<code>regsubsets()</code> function in the <strong>leaps</strong> package
<span class="citation">(Lumley &amp; Miller, 2020)</span> implements an
efficient algorithm for selecting the best-fitting linear least-squares
regressions for subsets of predictors of all sizes, from 1 through the
maximum number of candidate predictors.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> To illustrate the use
of <code>regsubsets()</code>, we employ the <code>swiss</code> data
frame supplied by the <strong>leaps</strong> package:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;leaps&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">head</span>(swiss)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co">#&gt;              Fertility Agriculture Examination Education Catholic</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co">#&gt; Courtelary        80.2        17.0          15        12     9.96</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co">#&gt; Delemont          83.1        45.1           6         9    84.84</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co">#&gt; Franches-Mnt      92.5        39.7           5         5    93.40</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co">#&gt; Moutier           85.8        36.5          12         7    33.77</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#&gt; Neuveville        76.9        43.5          17        15     5.16</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#&gt; Porrentruy        76.1        35.3           9         7    90.57</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#&gt;              Infant.Mortality</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co">#&gt; Courtelary               22.2</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a><span class="co">#&gt; Delemont                 22.2</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="co">#&gt; Franches-Mnt             20.2</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co">#&gt; Moutier                  20.3</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a><span class="co">#&gt; Neuveville               20.6</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co">#&gt; Porrentruy               26.6</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="fu">nrow</span>(swiss)</span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="co">#&gt; [1] 47</span></span></code></pre></div>
<p>The data set includes the following variables, for each of 47
French-speaking Swiss provinces circa 1888:</p>
<ul>
<li><code>Fertility</code>: A standardized fertility measure.</li>
<li><code>Agriculture</code>: The percentage of the male population
engaged in agriculture.</li>
<li><code>Examination</code>: The percentage of draftees into the Swiss
army receiving the highest grade on an examination.</li>
<li><code>Education</code>: The percentage of draftees with more than a
primary-school education.</li>
<li><code>Catholic</code>: The percentage of the population who were
Catholic.</li>
<li><code>Infant.Mortality</code>: The infant-mortality rate, expressed
as the percentage of live births surviving less than a year.</li>
</ul>
<p>Following <span class="citation">Lumley &amp; Miller (2020)</span>,
we treat <code>Fertility</code> as the response and the other variables
as predictors in a linear least-squares regression:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>m.swiss <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fertility <span class="sc">~</span> ., <span class="at">data=</span>swiss)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">summary</span>(m.swiss)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co">#&gt; lm(formula = Fertility ~ ., data = swiss)</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="co">#&gt; -15.274  -5.262   0.503   4.120  15.321 </span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="co">#&gt; (Intercept)       66.9152    10.7060    6.25  1.9e-07 ***</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="co">#&gt; Agriculture       -0.1721     0.0703   -2.45   0.0187 *  </span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co">#&gt; Examination       -0.2580     0.2539   -1.02   0.3155    </span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a><span class="co">#&gt; Education         -0.8709     0.1830   -4.76  2.4e-05 ***</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co">#&gt; Catholic           0.1041     0.0353    2.95   0.0052 ** </span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co">#&gt; Infant.Mortality   1.0770     0.3817    2.82   0.0073 ** </span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 7.17 on 41 degrees of freedom</span></span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.707,  Adjusted R-squared:  0.671 </span></span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a><span class="co">#&gt; F-statistic: 19.8 on 5 and 41 DF,  p-value: 5.59e-10</span></span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a><span class="fu">cv</span>(m.swiss, <span class="at">seed=</span><span class="dv">8433</span>)</span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a><span class="co">#&gt; R RNG seed set to 8433</span></span>
<span id="cb26-28"><a href="#cb26-28" tabindex="-1"></a><span class="co">#&gt; 10-Fold Cross Validation</span></span>
<span id="cb26-29"><a href="#cb26-29" tabindex="-1"></a><span class="co">#&gt; method: Woodbury</span></span>
<span id="cb26-30"><a href="#cb26-30" tabindex="-1"></a><span class="co">#&gt; criterion: mse</span></span>
<span id="cb26-31"><a href="#cb26-31" tabindex="-1"></a><span class="co">#&gt; cross-validation criterion = 59.683</span></span>
<span id="cb26-32"><a href="#cb26-32" tabindex="-1"></a><span class="co">#&gt; bias-adjusted cross-validation criterion = 58.846</span></span>
<span id="cb26-33"><a href="#cb26-33" tabindex="-1"></a><span class="co">#&gt; full-sample criterion = 44.788</span></span></code></pre></div>
<p>Thus, the MSE for the model fit to the complete data is considerably
smaller than the CV estimate of the MSE. Can we do better by selecting a
subset of the predictors, taking account of the additional uncertainty
induced by model selection?</p>
<p>First, let’s apply best-subset selection to the complete data
set:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>swiss.sub <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Fertility <span class="sc">~</span> ., <span class="at">data=</span>swiss)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="fu">summary</span>(swiss.sub)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="co">#&gt; Subset selection object</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="co">#&gt; Call: regsubsets.formula(Fertility ~ ., data = swiss)</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co">#&gt; 5 Variables  (and intercept)</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="co">#&gt;                  Forced in Forced out</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="co">#&gt; Agriculture          FALSE      FALSE</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="co">#&gt; Examination          FALSE      FALSE</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="co">#&gt; Education            FALSE      FALSE</span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="co">#&gt; Catholic             FALSE      FALSE</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a><span class="co">#&gt; Infant.Mortality     FALSE      FALSE</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="co">#&gt; 1 subsets of each size up to 5</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a><span class="co">#&gt; Selection Algorithm: exhaustive</span></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a><span class="co">#&gt;          Agriculture Examination Education Catholic Infant.Mortality</span></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a><span class="co">#&gt; 1  ( 1 ) &quot; &quot;         &quot; &quot;         &quot;*&quot;       &quot; &quot;      &quot; &quot;             </span></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a><span class="co">#&gt; 2  ( 1 ) &quot; &quot;         &quot; &quot;         &quot;*&quot;       &quot;*&quot;      &quot; &quot;             </span></span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a><span class="co">#&gt; 3  ( 1 ) &quot; &quot;         &quot; &quot;         &quot;*&quot;       &quot;*&quot;      &quot;*&quot;             </span></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a><span class="co">#&gt; 4  ( 1 ) &quot;*&quot;         &quot; &quot;         &quot;*&quot;       &quot;*&quot;      &quot;*&quot;             </span></span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a><span class="co">#&gt; 5  ( 1 ) &quot;*&quot;         &quot;*&quot;         &quot;*&quot;       &quot;*&quot;      &quot;*&quot;</span></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a>(bics <span class="ot">&lt;-</span> <span class="fu">summary</span>(swiss.sub)<span class="sc">$</span>bic)</span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a><span class="co">#&gt; [1] -19.603 -28.611 -35.656 -37.234 -34.553</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a><span class="fu">which.min</span>(bics)</span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">subsets</span>(swiss.sub, <span class="at">legend=</span><span class="st">&quot;topright&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Selecting the best model of each size." />
<p class="caption">
Selecting the best model of each size.
</p>
</div>
<p>The graph, produced by the <code>subsets()</code> function in the
<strong>car</strong> package, shows that the model with the smallest BIC
is the “best” model with 4 predictors, including
<code>Agriculture</code>, <code>Education</code>, <code>Catholic</code>,
and <code>Infant.Mortality</code>, but not <code>Examination</code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>m.best <span class="ot">&lt;-</span> <span class="fu">update</span>(m.swiss, . <span class="sc">~</span> . <span class="sc">-</span> Examination)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="fu">summary</span>(m.best)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co">#&gt; lm(formula = Fertility ~ Agriculture + Education + Catholic + </span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="co">#&gt;     Infant.Mortality, data = swiss)</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="co">#&gt; -14.676  -6.052   0.751   3.166  16.142 </span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)       62.1013     9.6049    6.47  8.5e-08 ***</span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="co">#&gt; Agriculture       -0.1546     0.0682   -2.27   0.0286 *  </span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a><span class="co">#&gt; Education         -0.9803     0.1481   -6.62  5.1e-08 ***</span></span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a><span class="co">#&gt; Catholic           0.1247     0.0289    4.31  9.5e-05 ***</span></span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a><span class="co">#&gt; Infant.Mortality   1.0784     0.3819    2.82   0.0072 ** </span></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 7.17 on 42 degrees of freedom</span></span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.699,  Adjusted R-squared:  0.671 </span></span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a><span class="co">#&gt; F-statistic: 24.4 on 4 and 42 DF,  p-value: 1.72e-10</span></span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a><span class="fu">cv</span>(m.best, <span class="at">seed=</span><span class="dv">8433</span>) <span class="co"># use same folds as before</span></span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a><span class="co">#&gt; R RNG seed set to 8433</span></span>
<span id="cb28-28"><a href="#cb28-28" tabindex="-1"></a><span class="co">#&gt; 10-Fold Cross Validation</span></span>
<span id="cb28-29"><a href="#cb28-29" tabindex="-1"></a><span class="co">#&gt; method: Woodbury</span></span>
<span id="cb28-30"><a href="#cb28-30" tabindex="-1"></a><span class="co">#&gt; criterion: mse</span></span>
<span id="cb28-31"><a href="#cb28-31" tabindex="-1"></a><span class="co">#&gt; cross-validation criterion = 58.467</span></span>
<span id="cb28-32"><a href="#cb28-32" tabindex="-1"></a><span class="co">#&gt; bias-adjusted cross-validation criterion = 57.778</span></span>
<span id="cb28-33"><a href="#cb28-33" tabindex="-1"></a><span class="co">#&gt; full-sample criterion = 45.916</span></span></code></pre></div>
<p>The MSE for the selected model is (of course) slightly higher than
for the full model fit previously, but the cross-validated MSE is a bit
lower; as we explain in the vignette on cross-validating model
selection, however, it isn’t kosher to select and cross-validate a model
on the same data.</p>
<p>Here’s a function named <code>selectSubsets()</code>, meant to be
used with <code>cvSelect()</code>, suitable for cross-validating the
model-selection process:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>selectSubsets <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> insight<span class="sc">::</span><span class="fu">get_data</span>(model),</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>                          model,</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>                          indices,</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>                          <span class="at">criterion =</span> mse,</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>                          <span class="at">details =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>                          seed,</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>                          <span class="at">save.model =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>                          ...) {</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(model, <span class="st">&quot;lm&quot;</span>, <span class="at">which =</span> <span class="cn">TRUE</span>) <span class="sc">!=</span> <span class="dv">1</span>)</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;selectSubsets is appropriate only for &#39;lm&#39; models&quot;</span>)</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>  </span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">GetResponse</span>(model)</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>  formula <span class="ot">&lt;-</span> <span class="fu">formula</span>(model)</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(model)</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>  </span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(indices)) {</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">missing</span>(seed) <span class="sc">||</span> <span class="fu">is.null</span>(seed))</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>      seed <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fl">1e6</span>, <span class="dv">1</span><span class="dt">L</span>)</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>    <span class="co"># select the best model from the full data by BIC</span></span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a>    sel <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(formula, <span class="at">data =</span> data, ...)</span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a>    bics <span class="ot">&lt;-</span> <span class="fu">summary</span>(sel)<span class="sc">$</span>bic</span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a>    best <span class="ot">&lt;-</span> <span class="fu">coef</span>(sel, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(bics))[[<span class="fu">which.min</span>(bics)]]</span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a>    x.names <span class="ot">&lt;-</span> <span class="fu">names</span>(best)</span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a>    <span class="co"># fit the best model; intercept is already in X, hence - 1:</span></span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a>    m.best <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X[, x.names] <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb29-26"><a href="#cb29-26" tabindex="-1"></a>    fit.all <span class="ot">&lt;-</span> <span class="fu">predict</span>(m.best, <span class="at">newdata =</span> data)</span>
<span id="cb29-27"><a href="#cb29-27" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb29-28"><a href="#cb29-28" tabindex="-1"></a>      <span class="at">criterion =</span> <span class="fu">criterion</span>(y, fit.all),</span>
<span id="cb29-29"><a href="#cb29-29" tabindex="-1"></a>      <span class="at">model =</span> <span class="cf">if</span> (save.model)</span>
<span id="cb29-30"><a href="#cb29-30" tabindex="-1"></a>        m.best <span class="co"># return best model</span></span>
<span id="cb29-31"><a href="#cb29-31" tabindex="-1"></a>      <span class="cf">else</span></span>
<span id="cb29-32"><a href="#cb29-32" tabindex="-1"></a>        <span class="cn">NULL</span></span>
<span id="cb29-33"><a href="#cb29-33" tabindex="-1"></a>    ))</span>
<span id="cb29-34"><a href="#cb29-34" tabindex="-1"></a>  }</span>
<span id="cb29-35"><a href="#cb29-35" tabindex="-1"></a>  </span>
<span id="cb29-36"><a href="#cb29-36" tabindex="-1"></a>  <span class="co"># select the best model omitting the i-th fold (given by indices)</span></span>
<span id="cb29-37"><a href="#cb29-37" tabindex="-1"></a>  sel.i <span class="ot">&lt;-</span> leaps<span class="sc">::</span><span class="fu">regsubsets</span>(formula, data[<span class="sc">-</span>indices,], ...)</span>
<span id="cb29-38"><a href="#cb29-38" tabindex="-1"></a>  bics.i <span class="ot">&lt;-</span> <span class="fu">summary</span>(sel.i)<span class="sc">$</span>bic</span>
<span id="cb29-39"><a href="#cb29-39" tabindex="-1"></a>  best.i <span class="ot">&lt;-</span> <span class="fu">coef</span>(sel.i, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(bics.i))[[<span class="fu">which.min</span>(bics.i)]]</span>
<span id="cb29-40"><a href="#cb29-40" tabindex="-1"></a>  x.names.i <span class="ot">&lt;-</span> <span class="fu">names</span>(best.i)</span>
<span id="cb29-41"><a href="#cb29-41" tabindex="-1"></a>  m.best.i <span class="ot">&lt;-</span> <span class="fu">lm</span>(y[<span class="sc">-</span>indices] <span class="sc">~</span> X[<span class="sc">-</span>indices, x.names.i] <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb29-42"><a href="#cb29-42" tabindex="-1"></a>  <span class="co"># predict() doesn&#39;t work here:</span></span>
<span id="cb29-43"><a href="#cb29-43" tabindex="-1"></a>  fit.all.i <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(X[, x.names.i] <span class="sc">%*%</span> <span class="fu">coef</span>(m.best.i))</span>
<span id="cb29-44"><a href="#cb29-44" tabindex="-1"></a>  fit.i <span class="ot">&lt;-</span> fit.all.i[indices]</span>
<span id="cb29-45"><a href="#cb29-45" tabindex="-1"></a>  <span class="co"># return the fitted values for i-th fold, CV criterion for all cases,</span></span>
<span id="cb29-46"><a href="#cb29-46" tabindex="-1"></a>  <span class="co">#   and the regression coefficients</span></span>
<span id="cb29-47"><a href="#cb29-47" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb29-48"><a href="#cb29-48" tabindex="-1"></a>    <span class="at">fit.i =</span> fit.i,</span>
<span id="cb29-49"><a href="#cb29-49" tabindex="-1"></a>    <span class="co"># fitted values for i-th fold</span></span>
<span id="cb29-50"><a href="#cb29-50" tabindex="-1"></a>    <span class="at">crit.all.i =</span> <span class="fu">criterion</span>(y, fit.all.i),</span>
<span id="cb29-51"><a href="#cb29-51" tabindex="-1"></a>    <span class="co"># CV crit for all cases</span></span>
<span id="cb29-52"><a href="#cb29-52" tabindex="-1"></a>    <span class="at">coefficients =</span> <span class="cf">if</span> (details) {</span>
<span id="cb29-53"><a href="#cb29-53" tabindex="-1"></a>      <span class="co"># regression coefficients</span></span>
<span id="cb29-54"><a href="#cb29-54" tabindex="-1"></a>      coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(m.best.i)</span>
<span id="cb29-55"><a href="#cb29-55" tabindex="-1"></a>      </span>
<span id="cb29-56"><a href="#cb29-56" tabindex="-1"></a>      <span class="co"># fix coefficient names</span></span>
<span id="cb29-57"><a href="#cb29-57" tabindex="-1"></a>      <span class="fu">names</span>(coefs) <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&quot;X</span><span class="sc">\\</span><span class="st">[-indices, x.names.i</span><span class="sc">\\</span><span class="st">]&quot;</span>, <span class="st">&quot;&quot;</span>,</span>
<span id="cb29-58"><a href="#cb29-58" tabindex="-1"></a>                          <span class="fu">names</span>(coefs))</span>
<span id="cb29-59"><a href="#cb29-59" tabindex="-1"></a>      </span>
<span id="cb29-60"><a href="#cb29-60" tabindex="-1"></a>      coefs</span>
<span id="cb29-61"><a href="#cb29-61" tabindex="-1"></a>    }  <span class="cf">else</span> {</span>
<span id="cb29-62"><a href="#cb29-62" tabindex="-1"></a>      <span class="cn">NULL</span></span>
<span id="cb29-63"><a href="#cb29-63" tabindex="-1"></a>    }</span>
<span id="cb29-64"><a href="#cb29-64" tabindex="-1"></a>  )</span>
<span id="cb29-65"><a href="#cb29-65" tabindex="-1"></a>}</span></code></pre></div>
<p>A slightly tricky point is that because of scoping issues,
<code>predict()</code> doesn’t work with the model fit omitting the
<span class="math inline">\(i\)</span>th fold, and so the fitted values
for all cases are computed directly as <span class="math inline">\(\widehat{\mathbf{y}}_{-i} = \mathbf{X}
\mathbf{b}_{-i}\)</span>, where <span class="math inline">\(\mathbf{X}\)</span> is the model-matrix for all of
the cases, and <span class="math inline">\(\mathbf{b}_{-i}\)</span> is
the vector of least-squares coefficients for the selected model with the
<span class="math inline">\(i\)</span>th fold omitted.</p>
<p>Additionally, the command
<code>lm(y[-indices] ~ X[-indices, x.names.i] - 1)</code>, which is the
selected model with the <span class="math inline">\(i\)</span>th fold
deleted, produces awkward coefficient names like
<code>&quot;X[-indices, x.names.i]Infant.Mortality&quot;</code>. Purely for
aesthetic reasons, the command
<code>sub(&quot;X\\[-indices, x.names.i\\]&quot;, &quot;&quot;, names(coefs))</code> fixes
these awkward names, removing the extraneous text,
<code>&quot;X[-indices, x.names.i]&quot;</code>.</p>
<p>Applying <code>selectSubsets()</code> to the full data produces the
full-data cross-validated MSE (which we obtained previously):</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">selectSubsets</span>(<span class="at">model=</span>m.swiss)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="co">#&gt; $criterion</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="co">#&gt; [1] 45.916</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;casewise loss&quot;)</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a><span class="co">#&gt; [1] &quot;(y - yhat)^2&quot;</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="co">#&gt; $model</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>Similarly, applying the function to an imaginary “fold” of 5 cases
returns the MSE for the cases in the fold, based on the model selected
and fit to the cases omitting the fold; the MSE for all of the cases,
based on the same model; and the coefficients of the selected model,
which includes 4 or the 5 predictors (and the intercept):</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">selectSubsets</span>(<span class="at">model=</span>m.swiss, <span class="at">indices=</span><span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">45</span>, <span class="at">by=</span><span class="dv">10</span>))</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="co">#&gt; $fit.i</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="co">#&gt; [1] 62.922 67.001 73.157 83.778 32.251</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="co">#&gt; $crit.all.i</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="co">#&gt; [1] 46.297</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;casewise loss&quot;)</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="co">#&gt; [1] &quot;(y - yhat)^2&quot;</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a><span class="co">#&gt; $coefficients</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a><span class="co">#&gt;      (Intercept)      Agriculture        Education         Catholic </span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a><span class="co">#&gt;         63.80452         -0.15895         -1.04218          0.13066 </span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a><span class="co">#&gt; Infant.Mortality </span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a><span class="co">#&gt;          1.01895</span></span></code></pre></div>
<p>Then, using <code>selectSubsets()</code> in cross-validation,
invoking the <code>cv.function()</code> method for <code>cv()</code>, we
get:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>(cv.swiss <span class="ot">&lt;-</span> <span class="fu">cv</span>(</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>  selectSubsets,</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>  <span class="at">working.model =</span> m.swiss,</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="at">data =</span> swiss,</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">8433</span> <span class="co"># use same folds</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>))</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="co">#&gt; R RNG seed set to 8433</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="co">#&gt; 10-Fold Cross Validation</span></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="co">#&gt; criterion: mse</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a><span class="co">#&gt; cross-validation criterion = 65.835</span></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="co">#&gt; bias-adjusted cross-validation criterion = 63.644</span></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a><span class="co">#&gt; full-sample criterion = 45.916</span></span></code></pre></div>
<p>Cross-validation shows that model selection exacts a penalty in MSE.
Examining the models selected for the 10 folds reveals that there is
some uncertainty in identifying the predictors in the “best” model, with
<code>Agriculture</code> sometimes appearing and sometimes not:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">compareFolds</span>(cv.swiss)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="co">#&gt; CV criterion by folds:</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="co">#&gt;   fold.1   fold.2   fold.3   fold.4   fold.5   fold.6   fold.7   fold.8 </span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="co">#&gt;  76.6964  61.3105 131.1616   9.0662  52.9403  41.0853  51.8768 136.9498 </span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a><span class="co">#&gt;   fold.9  fold.10 </span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a><span class="co">#&gt;  24.1808  82.2587 </span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="co">#&gt; Coefficients by folds:</span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="co">#&gt;         (Intercept) Catholic Education Infant.Mortality Agriculture</span></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a><span class="co">#&gt; Fold 1      59.0852   0.1397   -1.0203           1.2985       -0.17</span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a><span class="co">#&gt; Fold 2      67.0335   0.1367   -1.0499           0.9413       -0.20</span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a><span class="co">#&gt; Fold 3      55.0453   0.1221   -0.8757           1.3541       -0.15</span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a><span class="co">#&gt; Fold 4      62.5543   0.1236   -0.9719           1.0679       -0.16</span></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a><span class="co">#&gt; Fold 5      50.4643   0.1057   -0.7863           1.2144            </span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a><span class="co">#&gt; Fold 6      68.0289   0.1195   -1.0073           0.8294       -0.17</span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a><span class="co">#&gt; Fold 7      66.5219   0.1357   -1.0827           0.9523       -0.19</span></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a><span class="co">#&gt; Fold 8      46.3507   0.0776   -0.7637           1.4463            </span></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a><span class="co">#&gt; Fold 9      62.2632   0.1230   -1.0067           1.1000       -0.17</span></span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a><span class="co">#&gt; Fold 10     52.5112   0.1005   -0.7232           1.0809</span></span></code></pre></div>
<p>As well, the fold-wise MSE varies considerably, reflecting the small
size of the <code>swiss</code> data set (47 cases).</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-Fox:2016" class="csl-entry">
Fox, J. (2016). <em>Applied regression analysis and generalized linear
models</em> (Second edition). Thousand Oaks <span>CA</span>: Sage.
</div>
<div id="ref-FoxWeisberg:2019" class="csl-entry">
Fox, J., &amp; Weisberg, S. (2019). <em>An <span>R</span> companion to
applied regression</em> (Third edition). Thousand Oaks <span>CA</span>:
Sage.
</div>
<div id="ref-HamnerFrasco:2018" class="csl-entry">
Hamner, B., &amp; Frasco, M. (2018). <em>Metrics: Evaluation metrics for
machine learning</em>. Retrieved from <a href="https://CRAN.R-project.org/package=Metrics">https://CRAN.R-project.org/package=Metrics</a>
</div>
<div id="ref-LudeckeWaggonerMakowski:2019" class="csl-entry">
Lüdecke, D., Waggoner, P., &amp; Makowski, D. (2019). <span class="nocase">insight</span>: A unified interface to access information
from model objects in <span>R</span>. <em>Journal of Open Source
Software</em>, <em>4</em>(38), 1412.
</div>
<div id="ref-LumleyMiller:2020" class="csl-entry">
Lumley, T., &amp; Miller, A. (2020). <em><span class="nocase">leaps</span>: Regression subset selection</em>. Retrieved
from <a href="https://CRAN.R-project.org/package=leaps">https://CRAN.R-project.org/package=leaps</a>
</div>
<div id="ref-Wikipedia-ROC:2023" class="csl-entry">
&quot;Receiver operating characteristic&quot;. (2023). Receiver operating
characteristic—<span>W</span>ikipedia<span>,</span> the free
encyclopedia. Retrieved from <a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic">https://en.wikipedia.org/wiki/Receiver_operating_characteristic</a>
</div>
<div id="ref-VenablesRipley:2002" class="csl-entry">
Venables, W. N., &amp; Ripley, B. D. (2002). <em>Modern applied
statistics with <span>S</span></em> (Fourth edition). New York:
Springer.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>Try the following, for example, with both versions of
<code>cv.multinom()</code> (possibly replacing <code>ncores=2</code>
with a larger number):</p>
<pre><code>system.time(print(cv1 &lt;- cv(m.beps, k=&quot;loo&quot;)))
system.time(print(cv2 &lt;- cv(m.beps, k=&quot;loo&quot;, ncores=2)))
all.equal(cv1, cv2)</code></pre>
<a href="#fnref1" class="footnote-back">↩︎</a></li>
<li id="fn2"><p>A subtle point is that we added a <code>multinom</code>
argument to the local function <code>fPara()</code>, which is passed to
the <code>fPara</code> argument of <code>cvCompute()</code>. There is
also a <code>multinom</code> argument to <code>cvCompute()</code>, which
is set to the <code>multinom</code> function in the
<strong>nnet</strong> package. The <code>multinom</code> argument isn’t
directly defined in <code>cvCompute()</code> (examine the definition of
this function), but is passed through the <code>...</code> argument.
<code>cvCompute()</code>, in turn, will pass <code>multinom</code> to
<code>fPara()</code> via <code>...</code>, allowing <code>fPara()</code>
to find this function when it calls <code>update()</code> to refit the
model with each fold <code>i</code> omitted. This scoping issue arises
because <code>cvCompute()</code> uses <code>foreach()</code> for
parallel computations, even though the <strong>nnet</strong> package is
attached to the search path in the current R session via
<code>library(&quot;nnet&quot;)</code>. <code>cv.default()</code> is able to
handle the scoping issue transparently by automatically locating
<code>multinom()</code>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>This example is somewhat artificial in that
<code>glmmPQL()</code> has largely been superseded by computationally
superior functions, such the <code>glmer()</code> function in the
<strong>lme4</strong> package. There is, however, one situation in which
<code>glmmPQL()</code> might prove useful: to specify serial dependency
in case-level errors within clusters for longitudinal data, which is not
currently supported by <code>glmer()</code>.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>The <code>regsubsets()</code> function computes several
measures of model predictive performance, including the <span class="math inline">\(R^2\)</span> and <span class="math inline">\(R^2\)</span> adjusted for degrees of freedom, the
residual sums of squares, Mallows’s <span class="math inline">\(C_p\)</span>, and the BIC. Several of these are
suitable for comparing models with differing numbers of coefficients—we
use the BIC below—but all necessarily agree when comparing models with
the <em>same</em> number of coefficients.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
